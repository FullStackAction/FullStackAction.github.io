(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{417:function(t,a,s){"use strict";s.r(a);var n=s(15),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"一、repluginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、repluginx"}},[t._v("#")]),t._v(" 一、RePluginX")]),t._v(" "),a("p",[t._v("因 RePlugin 不支持 AndroidX，官方 github 已经好久不见有新的 Commits，一堆 issue 也没处理，难免让人觉得官方是否已经放弃了该项目。而公司开发需要使用到 RePlugin，但需要对其进行定制，向官方提交 pr 大概率是石沉大海，脑袋一拍，不如做做善事，自己基于 RePlugin 维护一个功能更强的 RePluginX，供有需要者使用，本人精力有限，欢迎有能力者一起维护~")]),t._v(" "),a("blockquote",[a("p",[t._v("注：如果 RePlugin 官方又开始活跃起来，积极加入一些新特性，且满足你的使用需求的话，强烈建议使用官方 RePlugin，毕竟开源不易。")])]),t._v(" "),a("h3",{attrs:{id:"_1、版本信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、版本信息"}},[t._v("#")]),t._v(" 1、版本信息")]),t._v(" "),a("ul",[a("li",[t._v("RePlugin Base 版本："),a("code",[t._v("2.3.4")])]),t._v(" "),a("li",[t._v("RePluginX release 版本："),a("code",[t._v("v0.0.6")])]),t._v(" "),a("li",[t._v("GitHub 地址："),a("a",{attrs:{href:"https://github.com/GitLqr/RePluginX",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/GitLqr/RePluginX"),a("OutboundLink")],1)])]),t._v(" "),a("h3",{attrs:{id:"_2、新特性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、新特性"}},[t._v("#")]),t._v(" 2、新特性")]),t._v(" "),a("p",[t._v("相比 RePlugin，RePluginX 支持以下新特性：")]),t._v(" "),a("ul",[a("li",[t._v("✅ 支持 AnroidSupport、AndroidX 工程")]),t._v(" "),a("li",[t._v("✅ 支持 RePlugin Transform 开关 配置 (enable)")]),t._v(" "),a("li",[t._v("✅ 支持 坑位 Activity 的屏幕方向 配置 (screenOrientation)")]),t._v(" "),a("li",[t._v("✅ 支持 多版本 AGP 2.x 3.x 4.x （7.x 暂未兼容）")]),t._v(" "),a("li",[t._v("📝 未完待续...")])]),t._v(" "),a("blockquote",[a("p",[t._v("注：后续 RePluginX 加入新特性时，我会在本文中继续追加。")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("AGP")]),t._v(" "),a("th",[t._v("Gradle Wrapper")]),t._v(" "),a("th",[t._v("Support")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("2.3.3")]),t._v(" "),a("td",[t._v("3.3 / 4.6")]),t._v(" "),a("td",[t._v("✔️")])]),t._v(" "),a("tr",[a("td",[t._v("3.2.1")]),t._v(" "),a("td",[t._v("4.6")]),t._v(" "),a("td",[t._v("✔️")])]),t._v(" "),a("tr",[a("td",[t._v("3.5.3")]),t._v(" "),a("td",[t._v("5.4.1")]),t._v(" "),a("td",[t._v("✔️")])]),t._v(" "),a("tr",[a("td",[t._v("4.1.1")]),t._v(" "),a("td",[t._v("6.5")]),t._v(" "),a("td",[t._v("✔️")])]),t._v(" "),a("tr",[a("td",[t._v("7.0.4")]),t._v(" "),a("td",[t._v("7.0.2")]),t._v(" "),a("td",[t._v("❌")])])])]),t._v(" "),a("blockquote",[a("p",[t._v("注：AGP 即 Android Gradle Plugin")])]),t._v(" "),a("h2",{attrs:{id:"二、lib-库兼容-androidx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、lib-库兼容-androidx"}},[t._v("#")]),t._v(" 二、lib 库兼容 AndroidX")]),t._v(" "),a("p",[t._v("RePluginX 即可以在 Support 工程中使用，也可以在 AndroidX 工程中使用，原理其实很简单：运行时判断工程使用的 android 兼容包类型，再加载其中一类代码即可。")]),t._v(" "),a("blockquote",[a("p",[t._v("原则：（宿主/插件）工程的类加载器只加载 "),a("code",[t._v("support")]),t._v(" 和 "),a("code",[t._v("androidx")]),t._v(" 其中的一种类，另一种类不能被类加载器加载。")])]),t._v(" "),a("p",[t._v("关键实现步骤如下：")]),t._v(" "),a("h3",{attrs:{id:"_1、引入-android-兼容包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、引入-android-兼容包"}},[t._v("#")]),t._v(" 1、引入 android 兼容包")]),t._v(" "),a("p",[t._v("通过 "),a("code",[t._v("provided / compileOnly")]),t._v(" 方式同时引入 "),a("code",[t._v("support-v4")]),t._v(" 和 "),a("code",[t._v("androidx.appcompat")]),t._v("，这样 lib 就能正常使用各自兼容包的 api 来编写代码，而编译时又不会包含 "),a("code",[t._v("support-v4")]),t._v(" 和 "),a("code",[t._v("androidx.appcompat")]),t._v(" 的类，避免工程编译时出现类冲突问题。")]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[t._v("provided "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'com.android.support:support-v4:25.2.0'")]),t._v("\nprovided "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'androidx.appcompat:appcompat:1.1.0'")]),t._v("\nprovided "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'androidx.localbroadcastmanager:localbroadcastmanager:1.0.0'")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("注：因为 "),a("code",[t._v("support-v4")]),t._v(" 包含有 "),a("code",[t._v("localbroadcastmanager")]),t._v("，而 "),a("code",[t._v("androidx.appcompat")]),t._v(" 则不包含，所以需要单独引入 "),a("code",[t._v("androidx.localbroadcastmanager")]),t._v("。")])]),t._v(" "),a("h3",{attrs:{id:"_2、判断-android-兼容包类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、判断-android-兼容包类型"}},[t._v("#")]),t._v(" 2、判断 android 兼容包类型")]),t._v(" "),a("p",[t._v("RePuginX 的 lib 库需要在运行时，通过反射判断（宿主/插件）工程真正使用的 android 兼容包类型，判断逻辑代码如下：")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * 兼容层配置\n *\n * @author LQR\n * @since 2021/12/8\n */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CompatConfig")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("volatile")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CompatConfig")]),t._v(" sInstance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DEPENDENCY_ANDROIDX")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DEPENDENCY_SUPPORT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// FIX: 宿主工程（空壳）不一定会依赖 androidx.appcompat，但是一定会依赖 androidx.localbroadcastmanager")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DEPENDENCY_ANDROIDX")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("findClassByClassName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"androidx.localbroadcastmanager.content.LocalBroadcastManager"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DEPENDENCY_SUPPORT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("findClassByClassName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"android.support.v4.content.LocalBroadcastManager"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// DEPENDENCY_ANDROIDX = findClassByClassName("androidx.fragment.app.FragmentActivity");')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// DEPENDENCY_SUPPORT = findClassByClassName("android.support.v4.app.FragmentActivity");')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("findClassByClassName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" className"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" hasDependency"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("className"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            hasDependency "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ClassNotFoundException")]),t._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            hasDependency "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" hasDependency"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_3、替换掉直接引入的-android-兼容包相关代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、替换掉直接引入的-android-兼容包相关代码"}},[t._v("#")]),t._v(" 3、替换掉直接引入的 android 兼容包相关代码")]),t._v(" "),a("p",[t._v("RePlugin 的 (host/plugin) lib 库存在着大量直接引用 "),a("code",[t._v("support")]),t._v(" 的代码，比如 "),a("code",[t._v("LocalBroadcastManager")]),t._v("、"),a("code",[t._v("@NonNull")]),t._v(" 等等，"),a("code",[t._v("@NonNull")]),t._v(" 直接全部移除掉即可，而 "),a("code",[t._v("LocalBroadcastManager")]),t._v(" 则需要做一层包装，针对不同的兼容包，加载对应的 "),a("code",[t._v("LocalBroadcastManager")]),t._v("。为了让 lib 库原来的代码尽量少改动，我创建了一个同名类 "),a("code",[t._v("LocalBroadcastManager")]),t._v("，由它来判断具体加载哪个兼容包下的 "),a("code",[t._v("LocalBroadcastManager")]),t._v("：")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * LocalBroadcastManager 兼容层\n *\n * @author LQR\n * @since 2021/12/8\n */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("abstract")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LocalBroadcastManager")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LocalBroadcastManager")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Context")]),t._v(" context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CompatConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DEPENDENCY_ANDROIDX")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LocalBroadcastManagerAndroidX")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CompatConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DEPENDENCY_SUPPORT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LocalBroadcastManagerSupport")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("abstract")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerReceiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BroadcastReceiver")]),t._v(" receiver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IntentFilter")]),t._v(" filter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("abstract")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("unregisterReceiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BroadcastReceiver")]),t._v(" receiver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("abstract")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendBroadcast")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Intent")]),t._v(" intent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("abstract")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendBroadcastSync")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Intent")]),t._v(" intent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * AndroidX 的 LocalBroadcastManager\n *\n * @author LQR\n * @since 2021/12/8\n */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LocalBroadcastManagerAndroidX")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LocalBroadcastManager")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("androidx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("localbroadcastmanager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),t._v("LocalBroadcastManager")]),t._v(" localBroadcastManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LocalBroadcastManagerAndroidX")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Context")]),t._v(" context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        localBroadcastManager "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("androidx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("localbroadcastmanager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),t._v("LocalBroadcastManager")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerReceiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BroadcastReceiver")]),t._v(" receiver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IntentFilter")]),t._v(" filter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        localBroadcastManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerReceiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("receiver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" filter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("unregisterReceiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BroadcastReceiver")]),t._v(" receiver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        localBroadcastManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("unregisterReceiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("receiver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendBroadcast")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Intent")]),t._v(" intent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" localBroadcastManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendBroadcast")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("intent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendBroadcastSync")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Intent")]),t._v(" intent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        localBroadcastManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendBroadcastSync")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("intent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * AndroidSupport 的 LocalBroadcastManager\n *\n * @author LQR\n * @since 2021/12/8\n */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LocalBroadcastManagerSupport")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LocalBroadcastManager")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("support"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("v4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),t._v("LocalBroadcastManager")]),t._v(" localBroadcastManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LocalBroadcastManagerSupport")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Context")]),t._v(" context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        localBroadcastManager "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("support"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("v4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),t._v("LocalBroadcastManager")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerReceiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BroadcastReceiver")]),t._v(" receiver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IntentFilter")]),t._v(" filter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        localBroadcastManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerReceiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("receiver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" filter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("unregisterReceiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BroadcastReceiver")]),t._v(" receiver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        localBroadcastManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("unregisterReceiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("receiver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendBroadcast")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Intent")]),t._v(" intent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" localBroadcastManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendBroadcast")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("intent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendBroadcastSync")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Intent")]),t._v(" intent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        localBroadcastManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendBroadcastSync")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("intent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("接着就是将 lib 库中所有的 "),a("code",[t._v("LocalBroadcastManager")]),t._v(" 导包进行替换即可。")]),t._v(" "),a("blockquote",[a("p",[t._v("注：RePlugin 的 (host/plugin) gradle 插件源码中也有着许多关于 "),a("code",[t._v("support")]),t._v(" 的处理部分，参照之，并对 "),a("code",[t._v("androidx")]),t._v(" 加入同样的处理代码配置即可，感兴趣的可自行查看 RePluginX 的 gradle 插件源码部分："),a("a",{attrs:{href:"https://github.com/GitLqr/RePluginX/tree/master/replugin-host-gradle",target:"_blank",rel:"noopener noreferrer"}},[t._v("replugin-host-gradle"),a("OutboundLink")],1),t._v("、"),a("a",{attrs:{href:"https://github.com/GitLqr/RePluginX/tree/master/replugin-plugin-gradle",target:"_blank",rel:"noopener noreferrer"}},[t._v("replugin-plugin-gradle"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"三、坑位屏幕方向"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、坑位屏幕方向"}},[t._v("#")]),t._v(" 三、坑位屏幕方向")]),t._v(" "),a("p",[t._v("因公司业务涉及 TV 行 业，TV 产品须固定为横屏，而 RePlugin 默认的 Activity 坑位是竖屏方向（插件清单文件中指定横屏是无效的，不妨自己试试看），所以需要对 RePlugin 进行定制，RePluginX 为了让满足 Moblie、TV 两类产品的需要，于是，在 host 的 gradle 配置中加入了 "),a("code",[t._v("screenOrientation")]),t._v(" 配置项，宿主工程可以要根据项目需要，配置坑位屏幕方向：")]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[t._v("apply plugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'replugin-host-gradle'")]),t._v("\nrepluginHostConfig "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    screenOrientation "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'landscape'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 坑位 Activity 方向（portrait / landscape）")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("要实现这个功能也简单，只需要修改 (host) gradle 插件的两处地方即可：")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("RePlugin.groovy")]),t._v(" 文件")])]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RepluginConfig")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * 屏幕方向\n     * 注意：默认是坚屏坑位：portrait，可配置为横屏坑位：landscape。\n     */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" screenOrientation "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token interpolation-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"portrait"')])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[a("code",[t._v("ComponentsGenerator.groovy")]),t._v(" 文件")])]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ComponentsGenerator")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// def static final oriV = 'portrait'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" oriV "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'portrait'")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("generateComponent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" applicationID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("applicationID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("generateMultiProcessComponent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" applicationID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("applicationID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * 更新配置\n     */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" applicationID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        oriV "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("screenOrientation\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"四、发布-jitpack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、发布-jitpack"}},[t._v("#")]),t._v(" 四、发布 jitpack")]),t._v(" "),a("p",[t._v("网上有很多发布 jitpack 的教程，基本操作如下：")]),t._v(" "),a("p",[a("strong",[t._v("Step 1：")]),t._v(" 工程根目录下的 "),a("code",[t._v("build.gradle")]),t._v(" 中添加如下插件依赖：")]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[t._v("classpath "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'com.github.dcendents:android-maven-gradle-plugin:2.1'")]),t._v("\n")])])]),a("p",[a("strong",[t._v("Step 2：")]),t._v(" lib 库目录下的 "),a("code",[t._v("build.gradle")]),t._v(" 中配置该插件：")]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[t._v("apply plugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'com.github.dcendents.android-maven'")]),t._v("\ngroup"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'com.github.username'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 例如：com.github.GitLqr")]),t._v("\n")])])]),a("p",[a("strong",[t._v("Step 3：")]),t._v(" 在工程的 github 网页中创建一个 release：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/202112121506383.png",alt:""}})]),t._v(" "),a("p",[a("strong",[t._v("Step 4：")]),t._v(" 在 "),a("a",{attrs:{href:"https://jitpack.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("jitpack.io"),a("OutboundLink")],1),t._v(" 搜索 "),a("code",[t._v("username/repoName")]),t._v("：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/202112121506171.png",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("注：release 刚刚创建时，还需要等 "),a("code",[t._v("jitpack.io")]),t._v(" 排队抓取，大概需要 5-10 分钟，可以通过图中 "),a("code",[t._v("Status")]),t._v(" 栏判断当前的抓取状态，当 "),a("code",[t._v("Log")]),t._v(" 栏出现文档 icon 时，说明抓取完毕，项目就可以正常依赖使用 lib 库了。")])]),t._v(" "),a("p",[a("strong",[t._v("Step 5：")]),t._v(" 点击 "),a("code",[t._v("Get it")]),t._v(" 按钮，根据依赖指引在项目工程中添加依赖即可：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/202112121517039.png",alt:""}})]),t._v(" "),a("p",[t._v("以上几步便是 jitpack 的发布流程了，眼尖的你可能会发现图中有个 "),a("code",[t._v("Subproject")]),t._v(" 下拉按钮，展开之后是长这样子的：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/202112121519492.png",alt:""}})]),t._v(" "),a("p",[t._v("这里需要提一下，网上的教程所举案例基本上都是一个 repo 对应一个 lib 库(module)，是不会有 "),a("code",[t._v("Subproject")]),t._v(" 下拉按钮的，而 RePluginX 则不一样，RePluginX 这个 repo 中包含了 2 个 lib 库和 2 个 gradle 插件：")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/GitLqr/RePluginX/tree/master/replugin-host-gradle",target:"_blank",rel:"noopener noreferrer"}},[t._v("【replugin-host-gradle】"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/GitLqr/RePluginX/tree/master/replugin-host-library",target:"_blank",rel:"noopener noreferrer"}},[t._v("【replugin-host-library】"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/GitLqr/RePluginX/tree/master/replugin-plugin-gradle",target:"_blank",rel:"noopener noreferrer"}},[t._v("【replugin-plugin-gradle】"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/GitLqr/RePluginX/tree/master/replugin-plugin-library",target:"_blank",rel:"noopener noreferrer"}},[t._v("【replugin-plugin-library】"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("是的，"),a("code",[t._v("jitpack.io")]),t._v(" 支持一个 repo 多 module 发布，通过在 google 上搜索到的几篇文章，给出的结论是，不管是 gradle 插件，或是 lib 库，配置的方式跟上面的一样，"),a("code",[t._v("jitpack.io")]),t._v(" 在抓取的时候会自动识别区分，但是依赖的规则会发生变化：")]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 一个repo对应一个lib库")]),t._v("\ncompile "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'com.github.USERNAME:REPO:VERSION'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 一个repo对应多个lib库")]),t._v("\ncompile "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'com.github.USERNAME.REPO:MODULE:VERSION'")]),t._v("\n")])])]),a("p",[t._v("比如【replugin-host-gradle】、【replugin-host-library】... 的 "),a("code",[t._v("build.gradle")]),t._v(" 中都是如下配置：")]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[t._v("apply plugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'com.github.dcendents.android-maven'")]),t._v("\ngroup"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'com.github.GitLqr'")]),t._v("\n")])])]),a("p",[t._v("之后各自的依赖配置如下：")]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[t._v("classpath "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'com.github.GitLqr.RePluginX:replugin-host-gradle:v0.0.4'")]),t._v("\nimplementation "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'com.github.GitLqr.RePluginX:replugin-host-library:v0.0.4'")]),t._v("\nclasspath "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'com.github.GitLqr.RePluginX:replugin-plugin-gradle:v0.0.4'")]),t._v("\nimplementation "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'com.github.GitLqr.RePluginX:replugin-plugin-library:v0.0.4'")]),t._v("\n")])])]),a("p",[t._v("关于"),a("code",[t._v("jitpack.io")]),t._v(" 一个 repo 发布多个 module 的相关文章：")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://jitpack.io/docs/ANDROID/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://jitpack.io/docs/ANDROID/"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://jlelse.blog/dev/multi-module-jitpack",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://jlelse.blog/dev/multi-module-jitpack"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://stackoverflow.com/questions/41959503/how-do-i-push-two-libraries-in-the-same-project-in-jitpack-io-using-android-stud",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://stackoverflow.com/questions/41959503/how-do-i-push-two-libraries-in-the-same-project-in-jitpack-io-using-android-stud"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"五、管理多个工程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、管理多个工程"}},[t._v("#")]),t._v(" 五、管理多个工程")]),t._v(" "),a("p",[t._v("RePluginX 与 RePlugin 在工程结构上有些许变化：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("Name")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("RePlugin")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("RePluginX")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("replugin-host-gradle")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("project")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("strong",[t._v("module")])])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("replugin-host-library")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("project")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("strong",[t._v("module")])])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("replugin-plugin-gradle")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("project")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("strong",[t._v("module")])])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("replugin-plugin-library")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("project")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("strong",[t._v("module")])])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("replugin-sample/host")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("project")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("project")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("replugin-sample/plugin/plugin-demo1")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("project")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("project")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("replugin-sample/plugin/plugin-demo2")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("project")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("project")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("replugin-sample/plugin/plugin-demo3-kotlin")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("project")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("project")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("replugin-sample/plugin/plugin-webview")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("project")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("project")])])])]),t._v(" "),a("ul",[a("li",[t._v("在 RePlugin 项目中，RePlugin 仅仅只是一个目录，该目录下包含了 n 个 project，例如【replugin-host-library】【replugin-plugin-library】分别是 2 个 project（有各自的 "),a("code",[t._v("settings.gradle")]),t._v(" 文件）")]),t._v(" "),a("li",[t._v("在 RePluginX 项目中，RePluginX 是一个真正的 project，【replugin-host-library】【replugin-plugin-library】 则是 RePluginX 的 2 个 module，RePluginX 现有 4 个 module，即【replugin-host-gradle】【replugin-host-library】【replugin-plugin-gradle】【replugin-plugin-library】。")])]),t._v(" "),a("p",[t._v("接下来就比较有意思了，我们知道 RePlugin 仅仅只是一个目录，这意味了，其下的所有工程，都必须各自开一个 AndroidStudio 来进行编码、调试，如果你电脑内存够大，还配有多个显示器，那可能也觉得没什么大不了的，但如果没有以上条件，就会觉得相当难受了。另外，我个人认为，如果一个项目，能在一个 AS 窗口下管理宿主和插件，会比较舒服（我希望一个 AS 窗口对应一个项目，而不是具体哪个工程），RePluginX 通过 gradle 3.1 提供的 "),a("code",[t._v("includeBuild")]),t._v(" 解决了这个问题，这是 RePluginX 根目录下 "),a("code",[t._v("settings.gradle")]),t._v(" 文件中的内容：")]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 当前工程 Module")]),t._v("\ninclude "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':replugin-host-gradle'")]),t._v("\ninclude "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':replugin-host-library'")]),t._v("\ninclude "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':replugin-plugin-gradle'")]),t._v("\ninclude "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':replugin-plugin-library'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Support Demo 工程")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("includeBuild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./replugin-sample/host'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("includeBuild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./replugin-sample/plugin/plugin-demo1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("includeBuild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./replugin-sample/plugin/plugin-demo2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("includeBuild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./replugin-sample/plugin/plugin-demo3-kotlin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("includeBuild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./replugin-sample/plugin/plugin-webview'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("includeBuild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./replugin-sample-extra/fresco/FrescoHost'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("includeBuild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./replugin-sample-extra/fresco/FrescoPlugin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// AndroidX Demo 工程")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("includeBuild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./repluginx-sample/host'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("includeBuild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./repluginx-sample/plugin/plugin-demo1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("并且在各个 project 根目录下的 "),a("code",[t._v("settings.gradle")]),t._v(" 文件中指定了 project 的名字，避免命名冲突：")]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// replugin-sample/host/settings.gradle")]),t._v("\nrootProject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'replugin-sample.host'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// repluginx-sample/host/settings.gradle")]),t._v("\nrootProject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'repluginx-sample.host'")]),t._v("\n")])])]),a("p",[t._v("于是乎，在 AS 打开 RePluginX 工程并加载完成之后，可以看到运行窗口会出现以下配置列表：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/202112121607422.png",alt:""}})]),t._v(" "),a("p",[t._v("这下就舒服了，强烈推荐业务项目也参照 RePluginX 管理多个 project 的方式，利用 "),a("code",[t._v("includeBuild")]),t._v(" 将 "),a("code",[t._v("宿主工程")]),t._v(" 和 "),a("code",[t._v("插件工程")]),t._v(" 用一个工程来管理，除此之外 "),a("code",[t._v("includeBuild")]),t._v(" 还可以配置替换掉子工程中的 Module 依赖，更多 "),a("code",[t._v("includeBuild")]),t._v(" 的使用请移步查阅 gradle 官方文档："),a("a",{attrs:{href:"https://docs.gradle.org/current/userguide/composite_builds.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.gradle.org/current/userguide/composite_builds.html"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"六、最后"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#六、最后"}},[t._v("#")]),t._v(" 六、最后")]),t._v(" "),a("p",[t._v("如果你觉得文章还不错，或是 RePluginX 这个项目能够对你有所帮助的话，不妨点个免费的 Star 或 Fork，这对我帮助很大，感谢。")]),t._v(" "),a("ul",[a("li",[t._v("GitHub 地址："),a("a",{attrs:{href:"https://github.com/GitLqr/RePluginX",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/GitLqr/RePluginX"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=e.exports}}]);
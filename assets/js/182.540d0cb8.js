(window.webpackJsonp=window.webpackJsonp||[]).push([[182],{527:function(t,e,o){"use strict";o.r(e);var r=o(15),n=Object(r.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("系列文章：")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://mp.weixin.qq.com/s/6AFd-4hyJQ6N7AVuJW4WIw",target:"_blank",rel:"noopener noreferrer"}},[t._v("《AI - stable-diffusion(AI 绘画)的搭建与使用》"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://mp.weixin.qq.com/s/-POx-c_fcMTtYU-6dWOaVg",target:"_blank",rel:"noopener noreferrer"}},[t._v("《AI - AI 绘画的精准控图(ControlNet)》"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://mp.weixin.qq.com/s/GvyOC101H3sALNtB67No4w",target:"_blank",rel:"noopener noreferrer"}},[t._v("《AI - stable-diffusion 艺术化二维码》"),e("OutboundLink")],1)])]),t._v(" "),e("h2",{attrs:{id:"一、介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一、介绍"}},[t._v("#")]),t._v(" 一、介绍")]),t._v(" "),e("p",[t._v("近日，AI 绘画（stable-diffusion）用来艺术化二维码算是比较火热的事了，这个 idea 是由国人用 Checkpoint + LoRA + QR Code ControlNet 组合实现出来的，下面是几张图片案例：")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20220417121922/image/202306181349292.png",alt:""}})]),t._v(" "),e("p",[t._v("这是原作者的文章："),e("a",{attrs:{href:"https://mp.weixin.qq.com/s/i4WR5ULH1ZZYl8Watf3EPw",target:"_blank",rel:"noopener noreferrer"}},[t._v("《AI 生成可扫码图像 — 新 ControlNet 模型展示》"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("不过，文章内并没有讲述艺术化二维码的具体过程，也没有现成的 "),e("code",[t._v("QR Code ControlNet")]),t._v(" 可供使用（可能出于某些原因没有公布吧，瞎猜的~），从网上收集了一些资料，使用现有的 ControlNet 模型也能够实现同样的效果，下面来看看具体实现步骤。")]),t._v(" "),e("h2",{attrs:{id:"二、实战"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二、实战"}},[t._v("#")]),t._v(" 二、实战")]),t._v(" "),e("p",[t._v("需要先下载 2 个 ControlNet 模型：")]),t._v(" "),e("ul",[e("li",[t._v("SD15_brightness："),e("a",{attrs:{href:"https://huggingface.co/ioclab/ioc-controlnet/tree/main/models",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://huggingface.co/ioclab/ioc-controlnet/tree/main/models"),e("OutboundLink")],1)]),t._v(" "),e("li",[t._v("SD15_tile："),e("a",{attrs:{href:"https://huggingface.co/lllyasviel/ControlNet-v1-1/tree/main",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://huggingface.co/lllyasviel/ControlNet-v1-1/tree/main"),e("OutboundLink")],1)])]),t._v(" "),e("p",[t._v("下载后存放到 "),e("code",[t._v("stable-diffusion-webui\\extensions\\sd-webui-controlnet\\models")]),t._v(" 目录下。")]),t._v(" "),e("blockquote",[e("p",[t._v("注：建议将 ControlNet 插件升级到最新版本，支持更多预处理器，还有更方便好用的 UI。")])]),t._v(" "),e("h3",{attrs:{id:"_1、生成二维码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、生成二维码"}},[t._v("#")]),t._v(" 1、生成二维码")]),t._v(" "),e("p",[t._v("我们先准备一张二维码图片，可以通过以下任意一个网址生成：")]),t._v(" "),e("ul",[e("li",[t._v("草料二维码："),e("a",{attrs:{href:"https://cli.im/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://cli.im/"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("code",[t._v("QR.io")]),t._v("："),e("a",{attrs:{href:"https://qr.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://qr.io/"),e("OutboundLink")],1)])]),t._v(" "),e("h3",{attrs:{id:"_2、灰度处理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、灰度处理"}},[t._v("#")]),t._v(" 2、灰度处理")]),t._v(" "),e("ol",[e("li",[t._v("上传二维码")]),t._v(" "),e("li",[t._v("ControlNet Unit 0：打钩启用（Enable）")]),t._v(" "),e("li",[t._v("预处理器（Preprocessor）："),e("code",[t._v("inpaint_global_harmonious")])]),t._v(" "),e("li",[t._v("模型（Model）："),e("code",[t._v("control_v1p_sd15_brightness")])]),t._v(" "),e("li",[t._v("权重（Control Weight）："),e("code",[t._v("0.4")])]),t._v(" "),e("li",[t._v("开始与停止步骤（Starting Control Step、Ending Control Step）："),e("code",[t._v("0")]),t._v(" 和 "),e("code",[t._v("1")])])]),t._v(" "),e("blockquote",[e("p",[t._v("注：如果你找不到 "),e("code",[t._v("inpaint_global_harmonious")]),t._v(" 预处理器，把 ControlNet 插件升级到最新就有了。")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20220417121922/image/202306181228753.png",alt:""}})]),t._v(" "),e("h3",{attrs:{id:"_3、细节处理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、细节处理"}},[t._v("#")]),t._v(" 3、细节处理")]),t._v(" "),e("ol",[e("li",[t._v("上传二维码")]),t._v(" "),e("li",[t._v("ControlNet Unit 1：打钩启用（Enable）")]),t._v(" "),e("li",[t._v("预处理器（Preprocessor）："),e("code",[t._v("inpaint_global_harmonious")])]),t._v(" "),e("li",[t._v("模型（Model）："),e("code",[t._v("control_v11f1e_sd15_tile")])]),t._v(" "),e("li",[t._v("权重（Control Weight）："),e("code",[t._v("0.6")])]),t._v(" "),e("li",[t._v("开始与停止步骤（Starting Control Step、Ending Control Step）："),e("code",[t._v("0.35")]),t._v(" 和 "),e("code",[t._v("0.75")])])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20220417121922/image/202306181229210.png",alt:""}})]),t._v(" "),e("blockquote",[e("p",[t._v("注：如果你页面上没有多个 ControlNet 单元，可以到 Settings 中，找到 Multiple ControlNets 进行设置，详见："),e("a",{attrs:{href:"https://mp.weixin.qq.com/s/-POx-c_fcMTtYU-6dWOaVg",target:"_blank",rel:"noopener noreferrer"}},[t._v("《AI - AI 绘画的精准控图(ControlNet)》"),e("OutboundLink")],1)])]),t._v(" "),e("h3",{attrs:{id:"_4、配置描述"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、配置描述"}},[t._v("#")]),t._v(" 4、配置描述")]),t._v(" "),e("p",[t._v("根据你希望在二维码画面中出现的东西进行配置，比如我希望在画面中出现一个战火中的高达，我的参数配置如下：")]),t._v(" "),e("ol",[e("li",[t._v("正向提示词（Prompt）："),e("code",[t._v("masterpiece, best quality, mecha, no humans, black armor, blue eyes, science fiction, fire, laser canon beam, war, conflict, destroyed city background")])]),t._v(" "),e("li",[t._v("反向提示词（Negative prompt）："),e("code",[t._v("UnrealisticDream, FastNegativeEmbedding")])]),t._v(" "),e("li",[t._v("采样方法（Sampling method）："),e("code",[t._v("Euler a")])]),t._v(" "),e("li",[t._v("采样步数（Sampling steps）："),e("code",[t._v("26")])]),t._v(" "),e("li",[t._v("CFG 比例（CFG Scale）："),e("code",[t._v("6.5")])]),t._v(" "),e("li",[t._v("随机种子（Seed）："),e("code",[t._v("1234843297")])])]),t._v(" "),e("blockquote",[e("p",[t._v("注：如果你不知道这些配置含义是什么，可以查阅这篇文章："),e("a",{attrs:{href:"https://mp.weixin.qq.com/s/6AFd-4hyJQ6N7AVuJW4WIw",target:"_blank",rel:"noopener noreferrer"}},[t._v("《AI - stable-diffusion(AI 绘画)的搭建与使用》"),e("OutboundLink")],1)])]),t._v(" "),e("p",[t._v("配置完描述后，点击 "),e("code",[t._v("Generate")]),t._v(" 按钮，等待图片生成即可：")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20220417121922/image/202306181234141.png",alt:""}})]),t._v(" "),e("p",[t._v("至此，艺术化后的二维码就生成好了，而且是可以被正常扫码识别出来的哦~")]),t._v(" "),e("h2",{attrs:{id:"三、资料"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三、资料"}},[t._v("#")]),t._v(" 三、资料")]),t._v(" "),e("p",[t._v("在上述实战中，出现了 1 个新的 ControlNet 预处理器和 2 个新的 ControlNet 模型，它们的作用分别是什么呢？")]),t._v(" "),e("h3",{attrs:{id:"_1、预处理器-inpaint-global-harmonious"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、预处理器-inpaint-global-harmonious"}},[t._v("#")]),t._v(" 1、预处理器 inpaint_global_harmonious")]),t._v(" "),e("p",[e("code",[t._v("inpaint_global_harmonious")]),t._v(" 主要用于局部（遮罩部分）重绘，在原生基于图生图的重绘模式上加入了 ControlNet 的控制，从而让 inpaint 能够更加准确的预测重绘细节。但是注意，和普通局部重绘不同，ControlNet 的 inpaint 模型除了重绘遮罩部分外，遮罩以外的地方也会发生微小变化（重绘），这样做带来的好处是它能够更好地将重绘区域与整体画面融合，让整体出图更加和谐统一。当然你也能将 ControlNet 引导权重调节到最大，此时 ControlNet-inpaint 模型将尽可能得保持遮罩区域以外的画面不发生变化。")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20220417121922/image/202306181303179.png",alt:"传统图生图 inpaint 效果"}})]),t._v(" "),e("p",[t._v("上图是传统图生图的局部重绘，原图蒙版重绘部分往往会出现与周围环境不相容的独立景物，无法统一整体布局。")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20220417121922/image/202306181303017.png",alt:"ControlNet inpaint 效果"}})]),t._v(" "),e("p",[t._v("可以看到，对比传统图生图的局部重绘，ControlNet 的 inpaint 模型能在统一整体效果的前提下，补全蒙版部分的内容，同时遮罩外部分的轮廓和细节也得到了较好的保留。")]),t._v(" "),e("blockquote",[e("p",[t._v("上述介绍源自：https://www.jianshu.com/p/2e433f71f544")])]),t._v(" "),e("h3",{attrs:{id:"_2、模型-control-v1p-sd15-brightness"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、模型-control-v1p-sd15-brightness"}},[t._v("#")]),t._v(" 2、模型 control_v1p_sd15_brightness")]),t._v(" "),e("p",[t._v("该模型为稳定扩散带来亮度控制，允许用户对灰度图像着色或对生成的图像重新着色。")]),t._v(" "),e("blockquote",[e("p",[t._v("上述介绍源自：\nhttps://aigc.ioclab.com/sd-showcase/brightness-controlnet.html"),e("br"),t._v("https://huggingface.co/ioclab/control_v1p_sd15_brightness")])]),t._v(" "),e("h3",{attrs:{id:"_3、模型-control-v11f1e-sd15-tile"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、模型-control-v11f1e-sd15-tile"}},[t._v("#")]),t._v(" 3、模型 control_v11f1e_sd15_tile")]),t._v(" "),e("p",[t._v("tile 模型原本是为了放大图片而设计的，具体来讲需要先将原图分割为一块一块的小区域(叫做 Tile 或瓦块)，然后分别对每个瓦块进行图生图放大，最后集合所有放大后的瓦块，拼成完整的大图。之所以采用局部放大后拼接的模式是为了减少显存占用。但是这样放大图片也有弊端，那就是必须要求每个小图在图生图时重绘幅度不能太大，因为本质上每个小图使用的也是全图提示词，当重回幅度过高时，老版本 tile 模型很可能会在每个小图里生成全图提示词所描绘的全部内容。")]),t._v(" "),e("p",[t._v("ControlNet1.1 版本后的 Tile 模型更加强大，它具有两种特性：")]),t._v(" "),e("ul",[e("li",[t._v("忽略图像中的细节并生成新的细节。")]),t._v(" "),e("li",[t._v("如果局部瓦片语义和提示不匹配，则忽略全局提示，并根据局部上下文引导扩散。")])]),t._v(" "),e("p",[t._v("因为该模型可以生成新的细节并忽略现有的图像细节，所以我们可以使用该模型去除不良细节并添加细化的细节。例如，消除由图像大小调整引起的模糊。")]),t._v(" "),e("blockquote",[e("p",[t._v("上述介绍源自：\nhttps://www.jianshu.com/p/2e433f71f544"),e("br"),t._v("https://github.com/lllyasviel/ControlNet-v1-1-nightly")])]),t._v(" "),e("h2",{attrs:{id:"四、分析"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#四、分析"}},[t._v("#")]),t._v(" 四、分析")]),t._v(" "),e("p",[t._v("我将实战中两个 ControlNet 单元依次生成的图片拆开，得到如下过程图：")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20220417121922/image/202306181328902.png",alt:""}})]),t._v(" "),e("p",[t._v("结合上述资料中对两个 ControlNet 模型的介绍，可以大致理解为 "),e("code",[t._v("control_v1p_sd15_brightness")]),t._v(" 在二维码图片的基础上进行重新着色，但会丢失二维码信息，"),e("code",[t._v("control_v11f1e_sd15_tile")]),t._v(" 则在此基础上，对二维码信息细节进行补充。至于预处理器 "),e("code",[t._v("inpaint_global_harmonious")]),t._v("，因为此场景下二维码并不需要进行 inpaint 处理，所以把预处理器设为 none 也是可以的，对结果并不影响。")])])}),[],!1,null,null,null);e.default=n.exports}}]);
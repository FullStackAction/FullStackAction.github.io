(window.webpackJsonp=window.webpackJsonp||[]).push([[88],{504:function(e,s,a){"use strict";a.r(s);var t=a(21),c=Object(t.a)({},(function(){var e=this,s=e._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("blockquote",[s("p",[e._v("在上一篇【"),s("RouterLink",{attrs:{to:"/pages/d4ac48/"}},[e._v("iOS-组件化开发（一）：远程私有库的基本使用")]),e._v("】中我们已经实战了远程私有库的基本操作，但是组件不可能上传一次就完事了，随着业务的增加，我们的组件可能还需要添加更多的东西，或者修复一些问题，这就需要我们对私有库代码进行升级与维护")],1)]),e._v(" "),s("p",[e._v("这里以对基础组件里添加了一个Cache工具为例")]),e._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205034.png",alt:"添加Cache工具"}})]),e._v(" "),s("p",[e._v("添加完成后我们需要更新到远程仓库")]),e._v(" "),s("h2",{attrs:{id:"一、更新远程仓库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、更新远程仓库"}},[e._v("#")]),e._v(" 一、更新远程仓库")]),e._v(" "),s("p",[e._v("cd 到本地仓库的位置，执行以下操作")]),e._v(" "),s("h3",{attrs:{id:"_1、代码更新"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1、代码更新"}},[e._v("#")]),e._v(" 1、代码更新")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("git add .\ngit commit -m '更新描述'\ngit push origin master\n")])])]),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205045.png",alt:"代码升级"}})]),e._v(" "),s("h3",{attrs:{id:"_2、版本更新"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2、版本更新"}},[e._v("#")]),e._v(" 2、版本更新")]),e._v(" "),s("p",[s("strong",[e._v("版本更新 这一步非常重要，为更新索引库做准备")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("git tag -a '新版本号' -m '注释'\ngit push --tags\n")])])]),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205109.png",alt:"版本升级"}})]),e._v(" "),s("p",[e._v("查看远程仓库，标签数已经有2个了，点进去就可以看到0.2.0，这里我们就不去看了")]),e._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205125.png",alt:""}})]),e._v(" "),s("h2",{attrs:{id:"二、修改描述文件并更新索引库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、修改描述文件并更新索引库"}},[e._v("#")]),e._v(" 二、修改描述文件并更新索引库")]),e._v(" "),s("h3",{attrs:{id:"_1、修改sepc"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1、修改sepc"}},[e._v("#")]),e._v(" 1、修改Sepc")]),e._v(" "),s("p",[e._v("打开你的"),s("code",[e._v("xx.podspec")]),e._v("文件，将原本的版本号改为"),s("code",[e._v("0.2.0")]),e._v("，与刚刚的tag保持一致")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v(" s.version = '0.2.0'\n")])])]),s("h3",{attrs:{id:"_2、验证远程spec"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2、验证远程spec"}},[e._v("#")]),e._v(" 2、验证远程Spec")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("pod spec lint --private\n")])])]),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205136.png",alt:"验证远程Spec"}})]),e._v(" "),s("h3",{attrs:{id:"_3、更新索引库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3、更新索引库"}},[e._v("#")]),e._v(" 3、更新索引库")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("pod repo push 索引库名称 xxx.podspec\n")])])]),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205159.png",alt:"更新索引库"}})]),e._v(" "),s("h2",{attrs:{id:"三、更新使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、更新使用"}},[e._v("#")]),e._v(" 三、更新使用")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("// --no-repo-update 不更新本地索引库\n// 因为刚刚已经自己手动更新过了，所以这里我们选择跳过更新\npod update --no-repo-update\n")])])]),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205210.png",alt:"更新框架"}})]),e._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205222.png",alt:"更新成功"}})]),e._v(" "),s("hr"),e._v(" "),s("h2",{attrs:{id:"四、第三方依赖"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、第三方依赖"}},[e._v("#")]),e._v(" 四、第三方依赖")]),e._v(" "),s("p",[e._v("当我们的私有库需要依赖其它第三方才可以正常使用时，我们就需要在spec文件中开启依赖，例如下面所示代码，表明当前仓库需要依赖AFN和SDWebImage")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("s.dependency 'AFNetworking', '~> 3.2.0'\ns.dependency 'SDWebImage', '~> 4.3.3'\n")])])]),s("p",[e._v("修改后更新操作同上所述，这里就不再赘述了。")]),e._v(" "),s("p",[e._v("但是这里存在一个问题，如果来了一位新的小伙伴，他所负责的部分只需要LXFBase下的Category，而LXFBase下的Cache才需要依赖SDWebImage，此时他若是pod一整个LXFBase岂不是平白无故安装了第三方依赖库，那应该怎么做呢？")]),e._v(" "),s("blockquote",[s("p",[e._v("方案就是可以通过子库Subspecs来解决因需要一个小小的工具而依赖整个基础组件的问题")])]),e._v(" "),s("h2",{attrs:{id:"五、子库subspecs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#五、子库subspecs"}},[e._v("#")]),e._v(" 五、子库Subspecs")]),e._v(" "),s("p",[e._v("什么是Subspecs？这里我们可以搜索一下SDWebImage")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("pod search 'SDWebImage'\n")])])]),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205235.png",alt:"Subspecs"}})]),e._v(" "),s("p",[e._v("可以看到，如果我们只需要用到SDWebImage中的GIF功能，那么并不需要将整个SDWebImage都下载下来，在Podfile中将"),s("s",[e._v("pod 'SDWebImage'")]),e._v(" 改为 "),s("code",[e._v("pod SDWebImage/GIF")]),e._v("即可单独使用这一功能")]),e._v(" "),s("p",[e._v("那接下来我们就来看看怎么描述一个子库吧")]),e._v(" "),s("h3",{attrs:{id:"子库格式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#子库格式"}},[e._v("#")]),e._v(" 子库格式")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("s.subspec '子库名称' do |别名|\n\nend\n")])])]),s("p",[e._v("因为这里已经分离出子库了，所以"),s("code",[e._v("s.source_files")]),e._v("和"),s("code",[e._v("s.dependency")]),e._v("就不能这么使用了，需要我们在子库里分别指定，所以我们直接把原来的"),s("code",[e._v("s.source_files")]),e._v("和"),s("code",[e._v("s.dependency")]),e._v("都注释掉。写法参考如下")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("# s.source_files = 'LXFBase/Classes/**/*'\n# s.dependency 'SDWebImage', '~> 4.3.3'\n\ns.subspec 'Cache' do |c|\n  c.source_files = 'LXFBase/Classes/Cache/**/*'\n  c.dependency 'SDWebImage', '~> 4.3.3'\nend\n\ns.subspec 'Category' do |c|\n  c.source_files = 'LXFBase/Classes/Category/**/*'\nend\n\ns.subspec 'Tool' do |t|\n  t.source_files = 'LXFBase/Classes/Tool/**/*'\nend\n")])])]),s("p",[e._v("修改后再按之前的步骤更新索引库和组件库就可以了")]),e._v(" "),s("p",[s("strong",[e._v("ps: 在添加第三方依赖描述后做验证或者上传操作可能会很慢，因为它在克隆第三方库如SDWebImage，有兴趣的可以在命令后面加入"),s("code",[e._v("--verbose")]),e._v("来查看详情情况")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("pod spec lint --private --verbose\n")])])]),s("p",[e._v("在成功更新组件库和索引库后我们再来搜索一下试试")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("pod search 'LXFBase'\n")])])]),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205257.png",alt:"subspec添加成功"}})]),e._v(" "),s("p",[e._v("现在就可以爱装哪个就装哪个了，在Podfile中指定要安装的子库就行了")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("pod 'LXFBase/Cache'\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("pod install\n")])])]),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205311.png",alt:"安装指定子库与依赖库"}})])])}),[],!1,null,null,null);s.default=c.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[141],{486:function(e,t,s){"use strict";s.r(t);var a=s(15),n=Object(a.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("iframe",{attrs:{src:"//player.bilibili.com/player.html?aid=1603068977&bvid=BV1Qm421L7ib&cid=1505310266&p=1",scrolling:"no",border:"0",frameborder:"no",framespacing:"0",allowfullscreen:"true",width:"100%",height:"560px"}}),e._v(" "),t("h2",{attrs:{id:"一、背景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、背景"}},[e._v("#")]),e._v(" 一、背景")]),e._v(" "),t("p",[e._v("上周一尝试从 "),t("code",[e._v("3.16.9")]),e._v(" 升级 "),t("code",[e._v("3.19.3")]),e._v("，主要有两个原因：")]),e._v(" "),t("p",[e._v("一是安卓端有一个疑似造成崩溃率上涨的 "),t("code",[e._v("bug")]),e._v(" 在 "),t("code",[e._v("Flutter 3.16")]),e._v(" 上出现，相关issue: "),t("a",{attrs:{href:"https://github.com/flutter/flutter/issues/138947",target:"_blank",rel:"noopener noreferrer"}},[e._v("#138947"),t("OutboundLink")],1),e._v(", 该 "),t("code",[e._v("bug")]),e._v(" 在 "),t("code",[e._v("3.13")]),e._v(" 不会出现，在 "),t("code",[e._v("3.17.pre")]),e._v(" 上得到修复，而 "),t("code",[e._v("3.16")]),e._v(" 之后的下个正式版本是 "),t("code",[e._v("3.19")]),e._v("。")]),e._v(" "),t("p",[e._v("二是苹果的隐私清单审核政策。")]),e._v(" "),t("p",[e._v("在苹果发布的【"),t("a",{attrs:{href:"https://developer.apple.com/cn/news/?id=3d8a9yyh",target:"_blank",rel:"noopener noreferrer"}},[e._v("关于 App Store 提交的隐私更新"),t("OutboundLink")],1),e._v("】新闻中指出")]),e._v(" "),t("blockquote",[t("p",[t("strong",[e._v("自 3 月 13 日起：")]),e._v(" 如果你上传新 App 或更新 App 到 App Store Connect，且该 App 使用了需要声明批准原因的 API，但你未在 App 的隐私清单中提供批准原因，我们会通过电子邮件告知你。这是对 App Store Connect 中现有通知的补充。")]),e._v(" "),t("p",[t("strong",[e._v("自 5 月 1 日起：")]),e._v(" 你需要就你的 App 代码使用的所列 API 提供批准原因，才能将新 App 或更新 App 上传到 App Store Connect。如果你没有合理的原因使用某个 API，请寻找替代的方案。如果你添加了常用第三方 SDK 列表中所列的新版第三方 SDK，那么这些 API、隐私清单和签名要求将应用于该 SDK。请务必使用包含其隐私清单的 SDK 版本，并注意在将该 SDK 添加为二进制依赖项时也需要提供签名。")])]),e._v(" "),t("p",[e._v("在苹果的【"),t("a",{attrs:{href:"https://developer.apple.com/cn/support/third-party-SDK-requirements/",target:"_blank",rel:"noopener noreferrer"}},[e._v("即将发布的第三方SDK要求"),t("OutboundLink")],1),e._v("】一文中，列举出需要隐私清单和签名的 "),t("code",[e._v("SDK")]),e._v("，其中就包含了 "),t("code",[e._v("Flutter")]),e._v("。为了符合该审核要求，"),t("code",[e._v("Flutter")]),e._v(" 从 "),t("code",[e._v("3.19")]),e._v(" 开始包含了 "),t("code",[e._v("PrivacyInfo.xcprivacy")]),e._v(" 这个隐私清单文件。")]),e._v(" "),t("p",[e._v("文件位于: "),t("a",{attrs:{href:"https://github.com/flutter/engine/blob/3.19.0/shell/platform/darwin/ios/framework/PrivacyInfo.xcprivacy",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/flutter/engine/blob/3.19.0/shell/platform/darwin/ios/framework/PrivacyInfo.xcprivacy"),t("OutboundLink")],1)]),e._v(" "),t("h2",{attrs:{id:"二、踩坑"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、踩坑"}},[e._v("#")]),e._v(" 二、踩坑")]),e._v(" "),t("p",[e._v("升到到 "),t("code",[e._v("3.19.3")]),e._v(" 后发现，从 "),t("code",[e._v("页面A")]),e._v(" 跳转到 "),t("code",[e._v("页面B")]),e._v(" 和返回 "),t("code",[e._v("页面A")]),e._v(" 时，"),t("code",[e._v("页面A")]),e._v(" 的 "),t("code",[e._v("build")]),e._v(" 方法都会被执行，降回 "),t("code",[e._v("3.16.9")]),e._v(" 则不会，这就很奇怪。后来发现是因为 "),t("code",[e._v("页面A")]),e._v(" 间接使用了 "),t("code",[e._v("ModalRoute.of")]),e._v("。")]),e._v(" "),t("p",[e._v("以下是可复现问题的代码")]),e._v(" "),t("div",{staticClass:"language-diff extra-class"},[t("pre",{pre:!0,attrs:{class:"language-diff"}},[t("code",[e._v("class PageA extends StatefulWidget {\n"),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" @override\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" State<PageA> createState() => _PageAState();\n")])]),e._v("}\n\nclass _PageAState extends State<PageA> {\n"),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" @override\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" Widget build(BuildContext context) {\n")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("   // ==== 这里 ====\n")])]),t("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("    final arguments = ModalRoute.of(context)?.settings.arguments;\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v('    print("PageA arguments:$arguments");\n')])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("   return Scaffold(\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("     appBar: AppBar(\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("       backgroundColor: Theme.of(context).colorScheme.inversePrimary,\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("       title: const Text('PageA'),\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("     ),\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("     body: const SizedBox.shrink(),\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("   );\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" }\n")])]),e._v("}\n")])])]),t("h2",{attrs:{id:"三、探索"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、探索"}},[e._v("#")]),e._v(" 三、探索")]),e._v(" "),t("p",[e._v("在经过一番摸索后，发现 "),t("code",[e._v("ModalRoute")]),e._v(" 在 "),t("code",[e._v("3.19")]),e._v(" 上面有一个小修改~")]),e._v(" "),t("p",[e._v("相关 "),t("code",[e._v("issue")]),e._v(" 是: "),t("a",{attrs:{href:"https://github.com/flutter/flutter/issues/112567",target:"_blank",rel:"noopener noreferrer"}},[e._v("#112567"),t("OutboundLink")],1),e._v(" 。")]),e._v(" "),t("p",[e._v("该 "),t("code",[e._v("issue")]),e._v(" 主要是涉及在 "),t("code",[e._v("Web")]),e._v(" 端上按 "),t("code",[e._v("Tab")]),e._v(" 键切换焦点的问题，后续有个 "),t("code",[e._v("PR")]),e._v(": "),t("a",{attrs:{href:"https://github.com/flutter/flutter/pull/130841",target:"_blank",rel:"noopener noreferrer"}},[e._v("#130841"),t("OutboundLink")],1),e._v(" 解决了该问题。")]),e._v(" "),t("blockquote",[t("p",[e._v("该 "),t("code",[e._v("PR")]),e._v(" 因内部测试原因进行了回滚，后再重新登陆，现PR: "),t("a",{attrs:{href:"https://github.com/flutter/flutter/pull/134554",target:"_blank",rel:"noopener noreferrer"}},[e._v("#134554"),t("OutboundLink")],1)])]),e._v(" "),t("p",[e._v("而在该 "),t("code",[e._v("PR")]),e._v(" 中就对 "),t("code",[e._v("ModalRoute")]),e._v(" 加了如下代码：")]),e._v(" "),t("div",{staticClass:"language-diff extra-class"},[t("pre",{pre:!0,attrs:{class:"language-diff"}},[t("code",[e._v("// packages/flutter/lib/src/widgets/routes.dart\n\nabstract class ModalRoute<T> extends TransitionRoute<T> with LocalHistoryRoute<T> {\n"),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" ...\n")])]),t("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("  @override\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("  void didChangeNext(Route<dynamic>? nextRoute) {\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("    super.didChangeNext(nextRoute);\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("    changedInternalState();\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("  }\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("  @override\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("  void didPopNext(Route<dynamic> nextRoute) {\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("    super.didPopNext(nextRoute);\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("    changedInternalState();\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("  }\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("\n")])]),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" @override\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" void changedInternalState() {\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("   super.changedInternalState();\n")])]),t("span",{pre:!0,attrs:{class:"token deleted-sign deleted"}},[t("span",{pre:!0,attrs:{class:"token prefix deleted"}},[e._v("-")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("    setState(() { /* internal state already changed */ });\n")]),t("span",{pre:!0,attrs:{class:"token prefix deleted"}},[e._v("-")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("    _modalBarrier.markNeedsBuild();\n")])]),t("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("    // No need to mark dirty if this method is called during build phase.\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("    if (SchedulerBinding.instance.schedulerPhase != SchedulerPhase.persistentCallbacks) {\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("      setState(() { /* internal state already changed */ });\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("      _modalBarrier.markNeedsBuild();\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("    }\n")])]),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("   _modalScope.maintainState = maintainState;\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" }\n")])]),e._v("...\n}\n")])])]),t("p",[t("code",[e._v("didChangeNext")]),e._v(" 和 "),t("code",[e._v("didPopNext")]),e._v(" 这两个方法对应的就是页面的 "),t("code",[e._v("push")]),e._v(" 和 "),t("code",[e._v("pop")]),e._v("，现在在该 "),t("code",[e._v("PR")]),e._v(" 中重写并调用了 "),t("code",[e._v("changedInternalState")]),e._v(" 方法，在 "),t("code",[e._v("changedInternalState")]),e._v(" 方法中调用了 "),t("code",[e._v("setState")]),e._v("。")]),e._v(" "),t("p",[e._v("下面将以高亮的方式标出重点代码（不是新增代码）。")]),e._v(" "),t("div",{staticClass:"language-diff extra-class"},[t("pre",{pre:!0,attrs:{class:"language-diff"}},[t("code",[e._v("abstract class ModalRoute<T> extends TransitionRoute<T> with LocalHistoryRoute<T> {\n"),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" ...\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" @protected\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" void setState(VoidCallback fn) {\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("   if (_scopeKey.currentState != null) {\n")])]),t("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("      _scopeKey.currentState!._routeSetState(fn);\n")])]),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("   } else {\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("     // The route isn't currently visible, so we don't have to call its setState\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("     // method, but we do still need to call the fn callback, otherwise the state\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("     // in the route won't be updated!\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("     fn();\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("   }\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" }\n")])]),e._v("...\n}\n")])])]),t("p",[e._v("这个 "),t("code",[e._v("ModalRoute")]),e._v(" 内的 "),t("code",[e._v("setState")]),e._v(" 会使 "),t("code",[e._v("_ModalScopeStatus")]),e._v(" 的 "),t("code",[e._v("_routeSetState")]),e._v(" 被调用，然后触发 "),t("code",[e._v("_ModalScopeState")]),e._v(" 的 "),t("code",[e._v("setState")]),e._v("，接着其 "),t("code",[e._v("child: _ModalScopeStatus")]),e._v(" 就开始 "),t("code",[e._v("rebuild")]),e._v(" 了。")]),e._v(" "),t("div",{staticClass:"language-diff extra-class"},[t("pre",{pre:!0,attrs:{class:"language-diff"}},[t("code",[e._v("class _ModalScopeState<T> extends State<_ModalScope<T>> {\n"),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" ...\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" void _routeSetState(VoidCallback fn) {\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("   if (widget.route.isCurrent && !_shouldIgnoreFocusRequest && _shouldRequestFocus) {\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("     widget.route.navigator!.focusNode.enclosingScope?.setFirstFocus(focusScopeNode);\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("   }\n")])]),t("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("    setState(fn);\n")])]),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" }\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" \n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" \n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" @override\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" Widget build(BuildContext context) {\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("   return AnimatedBuilder(\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("     ...\n")])]),t("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("      child: _ModalScopeStatus(\n")])]),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("       ...\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("     ),\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("   );\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" }\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" ...\n")])]),e._v("}\n")])])]),t("p",[e._v("如下代码所示，"),t("code",[e._v("_ModalScopeStatus")]),e._v(" 是一个 "),t("code",[e._v("InheritedWidget")]),e._v("，在经过一系列的处理后最终会走到其 "),t("code",[e._v("InheritedElement")]),e._v(" 的 "),t("code",[e._v("update")]),e._v(" 方法，在 "),t("code",[e._v("update")]),e._v(" 方法中通过调用 "),t("code",[e._v("updateShouldNotify")]),e._v(" 来判断数据是否发生变化，进而决定是否通知相关依赖。")]),e._v(" "),t("div",{staticClass:"language-diff extra-class"},[t("pre",{pre:!0,attrs:{class:"language-diff"}},[t("code",[t("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" class _ModalScopeStatus extends InheritedWidget {\n")])]),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" ...\n")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" @override\n")])]),t("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("  bool updateShouldNotify(_ModalScopeStatus old) {\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("    return isCurrent != old.isCurrent ||\n")])]),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("          canPop != old.canPop ||\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("          impliesAppBarDismissal != old.impliesAppBarDismissal ||\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("          route != old.route;\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" }\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" ...\n")])]),e._v("}\n")])])]),t("div",{staticClass:"language-diff extra-class"},[t("pre",{pre:!0,attrs:{class:"language-diff"}},[t("code",[e._v("class InheritedElement extends ProxyElement {\n"),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" ...\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" @override\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" void updated(InheritedWidget oldWidget) {\n")])]),t("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("    if ((widget as InheritedWidget).updateShouldNotify(oldWidget)) {\n")])]),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("     super.updated(oldWidget);\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("   }\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" }\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" ...\n")])]),e._v("}\n")])])]),t("p",[t("code",[e._v("_ModalScopeStatus")]),e._v(" 的 "),t("code",[e._v("isCurrent")]),e._v(" 表示当前页面是否处于最上层，所以在打开和关闭下一个页面时，其值必定切换，也就是 "),t("code",[e._v("updateShouldNotify")]),e._v(" 必定返回 "),t("code",[e._v("true")]),e._v("，既而通知依赖（实际上就是找出一个个依赖进行标脏，然后等待 "),t("code",[e._v("build")]),e._v(" 方法的重新调用）。")]),e._v(" "),t("p",[e._v("而我们在使用 "),t("code",[e._v("ModalRoute.of")]),e._v(" 的时候，内部就是将当前页的 "),t("code",[e._v("BuildContext")]),e._v(" 添加到依赖中，所以他这个改动就会影响到使用 "),t("code",[e._v("ModalRoute.of")]),e._v(" 的 "),t("code",[e._v("Widget")]),e._v("，使其多次 "),t("code",[e._v("rebuild")]),e._v("。")]),e._v(" "),t("div",{staticClass:"language-dart extra-class"},[t("pre",{pre:!0,attrs:{class:"language-dart"}},[t("code",[t("span",{pre:!0,attrs:{class:"token metadata function"}},[e._v("@optionalTypeArgs")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("ModalRoute")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("T")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("?")]),e._v(" of"),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("T")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Object")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("?")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("BuildContext")]),e._v(" context"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("final")]),e._v(" _ModalScopeStatus"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("?")]),e._v(" widget "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" context"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("dependOnInheritedWidgetOfExactType"),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),e._v("_ModalScopeStatus"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("return")]),e._v(" widget"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("?")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("route "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("as")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("ModalRoute")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("T")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("?")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),t("h2",{attrs:{id:"四、解决方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四、解决方案"}},[e._v("#")]),e._v(" 四、解决方案")]),e._v(" "),t("h3",{attrs:{id:"方案一-调整-modalroute-of"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#方案一-调整-modalroute-of"}},[e._v("#")]),e._v(" 方案一：调整 "),t("code",[e._v("ModalRoute.of")])]),e._v(" "),t("p",[e._v("在当前版本中，"),t("code",[e._v("of")]),e._v(" 的用意就是找到相应的 "),t("code",[e._v("ModalRoute")]),e._v(" 并且创建依赖关系，当数据改变时会重新 "),t("code",[e._v("build")]),e._v(" ，这是符合它期望用意的。")]),e._v(" "),t("p",[e._v("但是有些场景下我们并不希望有这个 “"),t("strong",[e._v("特性")]),e._v("”，比如，我打开新页面后，通过 "),t("code",[e._v("ModalRoute.of(context)?.settings.arguments")]),e._v(" 取路由参数，当前页面的取参，与跳转和关闭下个页面是没有任何关系的，所以这种场景下触发 "),t("code",[e._v("rebuild")]),e._v(" 将毫无意义。")]),e._v(" "),t("p",[e._v("所以我提了个 "),t("code",[e._v("PR")]),e._v(": "),t("a",{attrs:{href:"https://github.com/flutter/flutter/pull/145389",target:"_blank",rel:"noopener noreferrer"}},[e._v("#145389"),t("OutboundLink")],1),e._v(", 给 "),t("code",[e._v("ModalRoute.of")]),e._v(" 添加了 "),t("code",[e._v("createDependency")]),e._v(" 参数，为开发者提供了是否创建依赖的选择。目前还在审核中~")]),e._v(" "),t("div",{staticClass:"language-dart extra-class"},[t("pre",{pre:!0,attrs:{class:"language-dart"}},[t("code",[e._v("  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("ModalRoute")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("T")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("?")]),e._v(" of"),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("T")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Object")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("?")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("BuildContext")]),e._v(" context"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    bool createDependency "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    _ModalScopeStatus"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("?")]),e._v(" widget"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("if")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("createDependency"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n      widget "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" context"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("dependOnInheritedWidgetOfExactType"),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),e._v("_ModalScopeStatus"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("else")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n      widget "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" context\n          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("getElementForInheritedWidgetOfExactType"),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),e._v("_ModalScopeStatus"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n          "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("?")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("widget "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("as")]),e._v(" _ModalScopeStatus"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("?")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("return")]),e._v(" widget"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("?")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("route "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("as")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("ModalRoute")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("T")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("?")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),t("h3",{attrs:{id:"方案二-魔改源码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#方案二-魔改源码"}},[e._v("#")]),e._v(" 方案二：魔改源码")]),e._v(" "),t("p",[e._v("原 "),t("code",[e._v("PR")]),e._v(" 是对 "),t("code",[e._v("Tab")]),e._v(" 键切换焦点问题的修复，但对于移动端来说根本不算问题，因为用不上~ 😅 （当然，如果你们的用户有使用无障碍功能的，还需要自行斟酌一下）")]),e._v(" "),t("p",[e._v("如果这个问题到时还未解决（原 "),t("code",[e._v("PR")]),e._v(" 的作者还在休假），那我们也可以先注释掉相关代码对 "),t("code",[e._v("changedInternalState")]),e._v(" 的调用来应对")]),e._v(" "),t("div",{staticClass:"language-diff extra-class"},[t("pre",{pre:!0,attrs:{class:"language-diff"}},[t("code",[e._v("// packages/flutter/lib/src/widgets/routes.dart\n\nabstract class ModalRoute<T> extends TransitionRoute<T> with LocalHistoryRoute<T> {\n"),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" ...\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" @override\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" void didChangeNext(Route<dynamic>? nextRoute) {\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("   super.didChangeNext(nextRoute);\n")])]),t("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("    // changedInternalState();\n")])]),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" }\n")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" @override\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" void didPopNext(Route<dynamic> nextRoute) {\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("   super.didPopNext(nextRoute);\n")])]),t("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[e._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v("    // changedInternalState();\n")])]),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[e._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[e._v(" }\n")])]),e._v("}\n")])])]),t("p",[e._v("提供一个补丁")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 进入你的 flutter 目录，比如我用的是 fvm 下载的 3.19.3")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 记得将 cd 后面的路径换成你自己电脑上的~")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" /Users/lxf/fvm/versions/3.19.3\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 下载补丁")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-O")]),e._v(" https://raw.githubusercontent.com/LinXunFeng/flutter_assets/main/patch/01_rollbak_3_19_routes_change/0001-Roll-back-changes-to-routes.dart.patch\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 应用补丁")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" apply 0001-Roll-back-changes-to-routes.dart.patch\n")])])]),t("h2",{attrs:{id:"五、最后"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#五、最后"}},[e._v("#")]),e._v(" 五、最后")]),e._v(" "),t("p",[e._v("总而言之，距离5月1日（苹果强制要求添加隐私清单文件的期限）还有一个月，我们现在大可保持在 "),t("code",[e._v("3.13")]),e._v(" 版本先用着，免得折腾，同时也祈祷快点修复该问题，然后顺利升级上去~")])])}),[],!1,null,null,null);t.default=n.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{437:function(t,a,s){"use strict";s.r(a);var e=s(21),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v('"jCenter 不久后将停止服务" 这个消息对所有 Android 开发者的影响是很大的，很多好用的第三方库都会上传到 jCenter，而且几乎所有的 Android 项目里都会依赖到 jCenter 仓库，这意味着 Android 开发者对其有很强的依赖性。作为第三方库使用者来说，一旦到了 jCenter 停服那时，只有 2 种选择：')]),t._v(" "),a("ol",[a("li",[t._v("使用阿里等第三方代理仓库（上面可能会缓存着这些曾经托管在 jCenter 上的第三方库）")]),t._v(" "),a("li",[t._v("祈祷第三方库作者能早日同步库到 MavenCentral")])]),t._v(" "),a("blockquote",[a("p",[t._v("以下是其他人对 jCenter 停服事件的看法文章推荐，有兴趣可以去看看："),a("br"),t._v(" "),a("a",{attrs:{href:"https://blog.csdn.net/guolin_blog/article/details/115873573",target:"_blank",rel:"noopener noreferrer"}},[t._v("《浅谈 JCenter 即将被停止服务的事件》"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("回归主题，如果你是一个第三方库开发者，且之前没有上传库到 MavenCentral 经验的话，本文可以助你早日上传库到 MavenCentral~")]),t._v(" "),a("h2",{attrs:{id:"一、sonatype-账号"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、sonatype-账号"}},[t._v("#")]),t._v(" 一、Sonatype 账号")]),t._v(" "),a("h3",{attrs:{id:"_1、注册-sonatype"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、注册-sonatype"}},[t._v("#")]),t._v(" 1、注册 Sonatype")]),t._v(" "),a("p",[t._v("MavenCentral 和 Sonatype 的关系相当于 jCenter 和 jForg：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("库平台")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("运营商")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("管理后台")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("jCenter")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("jForg")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("bintray.com")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("MavenCentral")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("Sonatype")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("oss.sonatype.org")])])])]),t._v(" "),a("blockquote",[a("p",[t._v("注意：最新管理后台链接是："),a("code",[t._v("s01.oss.sonatype.org")]),t._v("，详情见"),a("a",{attrs:{href:"https://central.sonatype.org/publish/release/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://central.sonatype.org/publish/release/"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("所以，在上传库到 MavenCentral 之前，需要先注册登录 Sonatype，访问 "),a("a",{attrs:{href:"https://issues.sonatype.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://issues.sonatype.org"),a("OutboundLink")],1),t._v(" :")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/20210421191532.png",alt:""}})]),t._v(" "),a("p",[t._v("如果你已经有账号，则直接登录，否则点击 "),a("code",[t._v("Sign up")]),t._v(" 进入注册页面：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/20210421191546.png",alt:""}})]),t._v(" "),a("p",[t._v("填写好账号、密码、邮箱等信息即可注册成功，注册成功后再登录 Sonatype。")]),t._v(" "),a("blockquote",[a("p",[t._v("注意：邮箱很重要，建议是你常用的邮箱，才能及时收到 Sonatype 在 issue 中给你的答复信息提醒。")])]),t._v(" "),a("h3",{attrs:{id:"_2、申请上传权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、申请上传权限"}},[t._v("#")]),t._v(" 2、申请上传权限")]),t._v(" "),a("p",[t._v("现在你已经有 Sonatype 账号了，接下来理应就是借助 grdle 脚本经 管理后台("),a("code",[t._v("s01.oss.sonatype.org")]),t._v(") 把库上传到 MavenCentral ，但是，Sonatype 新用户默认是没有这个权限的，不信你可以访问 "),a("a",{attrs:{href:"https://s01.oss.sonatype.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("s01.oss.sonatype.org"),a("OutboundLink")],1),t._v('后，点击右上角 "Log In" 登录试试看，会提示没有权限：')]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/20210421191558.png",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("注意：出现这个弹窗有 2 种可能，一种是账号密码错误，另一种没有权限。")])]),t._v(" "),a("p",[t._v("所以，现在我们需要让 Sonatype 给我们开通这个权限，回到登录成功后跳转的那个页面"),a("a",{attrs:{href:"https://issues.sonatype.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("issues.sonatype.org"),a("OutboundLink")],1),t._v("，点击顶部的 "),a("code",[t._v("新建")]),t._v(" 按钮，填写项目信息：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/20210421191607.png",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("注意：图中是我个人项目信息，只是举例，不要照抄！！")])]),t._v(" "),a("p",[t._v("这个步骤中，唯一需要注意的地方就是 "),a("code",[t._v("Group Id")]),t._v("，有两种情况：")]),t._v(" "),a("ul",[a("li",[t._v("无网站域名：可以直接使用 github 的子域名 "),a("code",[t._v("io.github.username")]),t._v("，比如我的 github 账号名是 GitLqr，那么可以填写 "),a("code",[t._v("io.github.gitlqr")]),t._v("。")]),t._v(" "),a("li",[t._v("有网站域名：可以填写个人或公司域名，比如："),a("code",[t._v("com.gitlqr")]),t._v("，另外，还需要在 DNS 配置中配置一个 TXT 记录来验证域名所有权，具体请看："),a("a",{attrs:{href:"https://central.sonatype.org/pages/producers.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://central.sonatype.org/pages/producers.html"),a("OutboundLink")],1)])]),t._v(" "),a("blockquote",[a("p",[t._v("注意：目前已经不能再使用 "),a("code",[t._v("com.github")]),t._v(" 域名了，具体原因请看："),a("a",{attrs:{href:"https://central.sonatype.org/changelog/#2021-04-01-comgithub-is-not-supported-anymore-as-a-valid-coordinate",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://central.sonatype.org/changelog/#2021-04-01-comgithub-is-not-supported-anymore-as-a-valid-coordinate"),a("OutboundLink")],1),t._v("；使用自己的网站域名时，建议写顶级域名，不需要具体到某个项目的子域名，如此一来，"),a("code",[t._v("Group Id")]),t._v(" 只需要申请一次，以后你的其他库都使用同一个 "),a("code",[t._v("Group Id")]),t._v(" 即可。")])]),t._v(" "),a("p",[t._v('填写信息后，点击"新建"按钮，开启一个 issue，会显示 '),a("code",[t._v("wait for response")]),t._v("，等待 Sonatype 工作人员审核回复：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/20210421191617.png",alt:""}})]),t._v(" "),a("p",[t._v("因为 Sonatype 是国外运营，所以工作时间上会有时差，我们需要耐心等待 Sonatype 工作人员处理这个 issue，比如我这样：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/20210421210657.png",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("注意：如果你想尽快上传库，那么前面已经提到了，请使用你常用的邮箱，当 Sonatype 工作人员评论时，会第一时间通过邮件通知到你。")])]),t._v(" "),a("h2",{attrs:{id:"二、gradle-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、gradle-配置"}},[t._v("#")]),t._v(" 二、Gradle 配置")]),t._v(" "),a("p",[t._v("首次向 Sonatype 申请上传权限可能会有点久，我们可以同步处理 gradle 配置。")]),t._v(" "),a("h3",{attrs:{id:"_1、maven-提交脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、maven-提交脚本"}},[t._v("#")]),t._v(" 1、Maven 提交脚本")]),t._v(" "),a("p",[t._v("在项目根目录下新建一个 "),a("code",[t._v("maven-publish.gradle")]),t._v(" 文件，内容如下：")]),t._v(" "),a("blockquote",[a("p",[t._v("注意：以下内容是通用配置，直接拷贝即可。")])]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("project"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hasProperty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token interpolation-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"android"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Android libraries")]),t._v("\n    task "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sourcesJar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Jar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        classifier "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sources'")]),t._v("\n        from android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sourceSets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("srcDirs\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    task "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("javadoc")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Javadoc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// https://github.com/novoda/bintray-release/issues/71")]),t._v("\n        excludes "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'**/*.kt'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// < ---- Exclude all kotlin files from javadoc file.")]),t._v("\n        source "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sourceSets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("srcDirs\n        classpath "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" project"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("files")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBootClasspath")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("File"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pathSeparator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("encoding "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token interpolation-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"utf-8"')])]),t._v("\n        options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("charSet "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token interpolation-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"utf-8"')])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Java libraries")]),t._v("\n    task "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sourcesJar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Jar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dependsOn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" classes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        classifier "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sources'")]),t._v("\n        from sourceSets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("allSource\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 强制 Java/JavaDoc 等的编码为 UTF-8")]),t._v("\ntasks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("withType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("JavaCompile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("encoding "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token interpolation-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"UTF-8"')])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\ntasks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("withType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Javadoc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("encoding "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token interpolation-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"UTF-8"')])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\ntask "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("javadocJar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Jar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dependsOn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" javadoc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    classifier "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'javadoc'")]),t._v("\n    from javadoc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("destinationDir\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// add javadoc/source jar tasks as artifacts")]),t._v("\nartifacts "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    archives javadocJar\n    archives sourcesJar\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\napply plugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'maven'")]),t._v("\napply plugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'signing'")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Properties properties = new Properties()")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//properties.load(project.rootProject.file('local.properties').newDataInputStream())")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//def ossrhUsername = properties.getProperty("ossrhUsername")')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//def ossrhPassword = properties.getProperty("ossrhPassword")')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" PUBLISH_GROUP_ID "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" publishedGroupId "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//这里可以不是直接申请时候的groupId只要开头是就可以")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" PUBLISH_ARTIFACT_ID "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" artifact\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" PUBLISH_VERSION "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" libraryVersion "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// android.defaultConfig.versionName //这个是直接获取的库gradle里配置好的版本号，不用到处修改版本号，只需要维护一份就可以。")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//签名")]),t._v("\nsigning "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    required "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" gradle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("taskGraph"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hasTask")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token interpolation-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"uploadArchives"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    sign configurations"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("archives\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nuploadArchives "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    repositories "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        mavenDeployer "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n            beforeDeployment "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" MavenDeployment deployment "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" signing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("signPom")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("deployment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("repository")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token interpolation-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://s01.oss.sonatype.org/service/local/staging/deploy/maven2/"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("authentication")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("userName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ossrhUsername"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ossrhPassword"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("snapshotRepository")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token interpolation-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://s01.oss.sonatype.org/content/repositories/snapshots/"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("authentication")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("userName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ossrhUsername"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ossrhPassword"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n            pom"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("groupId "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" PUBLISH_GROUP_ID\n            pom"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("artifactId "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" PUBLISH_ARTIFACT_ID\n            pom"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("version "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" PUBLISH_VERSION\n\n            pom"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("project "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                packaging "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'aar'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//我这里发布的是安卓的包，所有写的aar")]),t._v("\n\n                name libraryName "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// '发布库的简单名称'")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// optionally artifactId can be defined here")]),t._v("\n                description libraryDescription "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// '发布包的描述'")]),t._v("\n                url siteUrl "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// '可以写公司官网地址或github个人页面地址'")]),t._v("\n\n                scm "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    connection gitUrl "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 'scm:替换成项目git地址'")]),t._v("\n                    developerConnection gitUrl "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 'scm:替换为git开头的项目地址'")]),t._v("\n                    url siteUrl "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// '项目首页，可以是github项目的主页'")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n                licenses "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    license "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                        name licenseName "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 'The Apache License, Version 2.0'")]),t._v("\n                        url licenseUrl "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 'http://www.apache.org/licenses/LICENSE-2.0.txt'")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n                developers "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    developer "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                        id developerId "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// '这里填写申请账号时候的全名就可以'")]),t._v("\n                        name developerName "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// '这里随意填写就可以'")]),t._v("\n                        email developerEmail"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// '最好是申请账号时用的邮箱'")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_2、maven-库信息配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、maven-库信息配置"}},[t._v("#")]),t._v(" 2、Maven 库信息配置")]),t._v(" "),a("p",[t._v("库信息共用两处配置：")]),t._v(" "),a("ul",[a("li",[t._v("通用信息：填写在项目根目录下的 "),a("code",[t._v("gradle.prperties")]),t._v(" 文件中。")]),t._v(" "),a("li",[t._v("Module 信息：填写在具体 Module 目录下的 "),a("code",[t._v("build.gradle")]),t._v(" 文件中。")])]),t._v(" "),a("h4",{attrs:{id:"通用信息-gradle-prperties-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通用信息-gradle-prperties-配置"}},[t._v("#")]),t._v(" 通用信息 "),a("code",[t._v("gradle.prperties")]),t._v(" 配置")]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[t._v("publishedGroupId"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("你申请权限时填写的GroupId\nsiteUrl"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("项目url\ngitUrl"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("git链接\ndeveloperId"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("账号id\ndeveloperName"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("账号id\ndeveloperEmail"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("邮箱\n\nlicenseName"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("The Apache Software License"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Version "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),t._v("\nlicenseUrl"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token interpolation-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v("//")])]),t._v("www"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("org"),a("span",{pre:!0,attrs:{class:"token interpolation-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v("/licenses/")])]),t._v("LICENSE"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt\nallLicenses"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token interpolation-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Apache-2.0"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("具体可参考 "),a("a",{attrs:{href:"https://github.com/GitLqr/LiteARouter/blob/main/gradle.properties",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/GitLqr/LiteARouter/blob/main/gradle.properties"),a("OutboundLink")],1)]),t._v(" "),a("h4",{attrs:{id:"module-信息-build-gradle-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#module-信息-build-gradle-配置"}},[t._v("#")]),t._v(" Module 信息 "),a("code",[t._v("build.gradle")]),t._v(" 配置")]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[t._v("ext "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    artifact "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'库的唯一标识'")]),t._v("\n    libraryName "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'发布库的简单名称'")]),t._v("\n    libraryDescription "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'发布包的描述'")]),t._v("\n    libraryVersion "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'发布库的版本号'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("具体可参考 "),a("a",{attrs:{href:"https://github.com/GitLqr/LiteARouter/blob/main/litearouter-api/build.gradle",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/GitLqr/LiteARouter/blob/main/litearouter-api/build.gradle"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"_3、导入-maven-脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、导入-maven-脚本"}},[t._v("#")]),t._v(" 3、导入 Maven 脚本")]),t._v(" "),a("p",[t._v("在库对应的 Module 目录下的"),a("code",[t._v("build.gradle")]),t._v("文件底部添加如下代码：")]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[t._v("apply from"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../maven-publish.gradle'")]),t._v("\n")])])]),a("p",[t._v("在 AS 中 "),a("code",[t._v("Sync Now")]),t._v(" 一下 Gradle，就可以在 Gradle 面板中看到多了一个 "),a("code",[t._v("upload/uploadArchives")]),t._v(" 任务了。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/20210421191641.png",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"三、gpg-签名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、gpg-签名"}},[t._v("#")]),t._v(" 三、GPG 签名")]),t._v(" "),a("p",[t._v("通过以上两步之后，还差最后一步，此时你运行 "),a("code",[t._v("uploadArchives")]),t._v(" 任务是无法正常提交的，MavenCentral 提交还需要配置 GPG 签名文件。")]),t._v(" "),a("h3",{attrs:{id:"_1、使用-gpg4win-生成-gpg-密钥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、使用-gpg4win-生成-gpg-密钥"}},[t._v("#")]),t._v(" 1、使用 Gpg4win 生成 GPG 密钥")]),t._v(" "),a("blockquote",[a("p",[t._v("注意：以下生成 GPG 密钥的操作流程使用的是 Window 环境，如果你使用的是 Mac，请参考："),a("a",{attrs:{href:"https://www.jianshu.com/p/1c715203c7c6",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.jianshu.com/p/1c715203c7c6"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("先到"),a("a",{attrs:{href:"https://www.gpg4win.org/get-gpg4win.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.gpg4win.org/get-gpg4win.html"),a("OutboundLink")],1),t._v("下载安装好 Gpg4win：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/20210421191653.png",alt:""}})]),t._v(" "),a("p",[t._v('启动 Gpg4win，点击 "文件" - "新建密钥对..."：')]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/20210421191702.png",alt:""}})]),t._v(" "),a("p",[t._v("创建个人 OpenPGP 密钥对：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/20210421191711.png",alt:""}})]),t._v(" "),a("p",[t._v("填写账号、邮箱，并勾选 "),a("code",[t._v("Protect the generated key with a passphrase")]),t._v("：")]),t._v(" "),a("blockquote",[a("p",[t._v("注意：在高级设置里可以设置更详细的，例如过期时间，但过期时间不可以太长，或报错。")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/20210421191720.png",alt:""}})]),t._v(" "),a("p",[t._v('点击 "新建"， 设置密码（确认密码）：')]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/20210421191728.png",alt:""}})]),t._v(" "),a("p",[t._v('等待生成密钥后，出现如下弹窗，点击 "完成"：')]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/20210421191736.png",alt:""}})]),t._v(" "),a("p",[t._v("在主界面双击刚刚创建好的密钥，会出现如下弹窗，需要把底部的那 8 个字符复制下来，在后面的【配置密钥】环节会用到：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/20210421191744.png",alt:""}})]),t._v(" "),a("p",[t._v('在主界面右击刚刚创建好的密钥，点击 "在服务器上发布..."，然后一路确定：')]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/20210421191751.png",alt:""}})]),t._v(" "),a("p",[t._v('在主界面右击刚刚创建好的密钥，点击 "导出..."，这时注意了，一定要在这里先把文件名改成 "gpg" 或者 "pgp"，再点保存：')]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/20210421191801.png",alt:""}})]),t._v(" "),a("p",[t._v("注意了，Gpg4win 的导出分为两种：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v('"导出..."')]),t._v(": 导出公钥")]),t._v(" "),a("li",[a("code",[t._v('"Backup Secret Keys"')]),t._v(": 导出 "),a("code",[t._v("私钥")]),t._v(" !!")])]),t._v(" "),a("blockquote",[a("p",[t._v("提示：后续步骤需要用到的是 "),a("code",[t._v("私钥")]),t._v("，所以需要点 "),a("code",[t._v('"Backup Secret Keys"')]),t._v(' 导出私钥的 gpg 文件；导出时默认文件后缀是 "asc"，一定要在这时修改后缀为 "gpg"，这样才能生成正确的 '),a("code",[t._v("二进制 gpg 密钥文件")]),t._v("。如果先保存成 "),a("code",[t._v("asc 文本文件")]),t._v("，再修改成 gpg 是没有用的！！！")])]),t._v(" "),a("h3",{attrs:{id:"_2、配置密钥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、配置密钥"}},[t._v("#")]),t._v(" 2、配置密钥")]),t._v(" "),a("p",[t._v("这一步很关键，需要在电脑 "),a("code",[t._v("用户目录")]),t._v(" 下的 "),a("code",[t._v(".gradle/gradle.properties")]),t._v(" 中配置如下内容：")]),t._v(" "),a("blockquote",[a("p",[t._v("比如："),a("code",[t._v("C:\\Users\\CharyLin\\.gradle\\gradle.properties")])])]),t._v(" "),a("div",{staticClass:"language-properties extra-class"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# MavenCentral")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("signing.keyId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("刚才获取的密钥后8位")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("signing.password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("之前我们执行命令时设置的密码")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("signing.secretKeyRingFile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("刚才生成的gpg文件路径")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("ossrhUsername")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("sonatype用户名")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("ossrhPassword")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("sonatype密码")]),t._v("\n")])])]),a("h2",{attrs:{id:"四、发布"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、发布"}},[t._v("#")]),t._v(" 四、发布")]),t._v(" "),a("h3",{attrs:{id:"_1、上传档案-uploadarchives"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、上传档案-uploadarchives"}},[t._v("#")]),t._v(" 1、上传档案(uploadArchives)")]),t._v(" "),a("p",[t._v("到了这一步，就可以去 Gradle 面板中双击执行 "),a("code",[t._v("uploadArchives")]),t._v(" 任务了，成功的话，会出现如下日志：")]),t._v(" "),a("div",{staticClass:"language-PlainText extra-class"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[t._v("11:12:00: Executing task 'uploadArchives'...\n\n...\n\n> Task :litearouter-api:sourcesJar UP-TO-DATE\n> Task :litearouter-api:signArchives UP-TO-DATE\n> Task :litearouter-api:uploadArchives\n\n...\n\nBUILD SUCCESSFUL in 16s\n23 actionable tasks: 1 executed, 22 up-to-date\n11:12:16: Task execution finished 'uploadArchives'.\n")])])]),a("p",[t._v("如果出现 "),a("code",[t._v("Unable to read secret key from file: it may not be a PGP secret key ring")]),t._v(" 的错误，有以下三种可能：")]),t._v(" "),a("ul",[a("li",[t._v("GPG 账号、密码有误")]),t._v(" "),a("li",[t._v("使用的是 GPG 公钥文件")]),t._v(" "),a("li",[t._v("使用的是 GPG 密钥文件，但是是先保存成 asc 文件后修改成 gpg 文件")])]),t._v(" "),a("div",{staticClass:"language-PlainText extra-class"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[t._v("FAILURE: Build failed with an exception.\n\n* What went wrong:\nCould not evaluate onlyIf predicate for task ':litearouter-annotation:signArchives'.\n> Unable to read secret key from file: D:\\CharyLinDatas\\GitLqr\\secret.gpg (it may not be a PGP secret key ring)\n\n* Try:\nRun with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output. Run with --scan to get full insights.\n\n* Get more help at https://help.gradle.org\n\nBUILD FAILED in 11s\n")])])]),a("h3",{attrs:{id:"_2、发布档案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、发布档案"}},[t._v("#")]),t._v(" 2、发布档案")]),t._v(" "),a("p",[t._v("现在可以去登录下的管理后台 "),a("a",{attrs:{href:"https://s01.oss.sonatype.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://s01.oss.sonatype.org/"),a("OutboundLink")],1),t._v(', 然后点击左侧的 "Staging Repositories":')]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/20210421204120.png",alt:""}})]),t._v(" "),a("p",[t._v("选中刚上传的包, 底部的 "),a("code",[t._v("Content")]),t._v(" 选项卡下,可以看到包内的文件有哪些:")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/20210421204142.png",alt:""}})]),t._v(" "),a("p",[t._v('确定无误后, 点击 "Close", 填写描述信息, 然后点击 "Confirm":')]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/20210421204157.png",alt:""}})]),t._v(" "),a("p",[t._v("正常情况下, 等待几分钟后, "),a("code",[t._v("Activity")]),t._v(' 选项卡中出现对号的 "Repository closed" 就是 close 成功了:')]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/20210421204208.png",alt:""}})]),t._v(" "),a("p",[t._v('然后再点击 "Release" 按钮即可发布到 MavenCentral, 等待几个小时后可以在 '),a("a",{attrs:{href:"https://search.maven.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://search.maven.org/"),a("OutboundLink")],1),t._v(" 查询发布结果。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20210320170901/image/20210421204526.png",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v('因为 Release 时勾选了 "Automatically Drop" 选项, 所以当包发布成功之后会自动从 Staging Repository 中删除。')])]),t._v(" "),a("p",[t._v("需要注意的是, 如果你的库有好几个 component, 像我的项目就包含了 "),a("code",[t._v("litearouter-annotation")]),t._v(" 、"),a("code",[t._v("litearouter-api")]),t._v(" 、"),a("code",[t._v("litearouter-compiler")]),t._v(" 三个, 切记一个一个按流程来, 比如:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("litearouter-annotation")]),t._v(": upload --\x3e close --\x3e release")]),t._v(" "),a("li",[a("code",[t._v("litearouter-api")]),t._v(": upload --\x3e close --\x3e release")]),t._v(" "),a("li",[a("code",[t._v("litearouter-compiler")]),t._v(": upload --\x3e close --\x3e release")])]),t._v(" "),a("p",[t._v("不要一次性全部 upload, 然后又一次性 close, 最后再一次性 release, 这种做法不确定会带来什么后果, 建议不要这样搞。")]),t._v(" "),a("h2",{attrs:{id:"五、补充"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、补充"}},[t._v("#")]),t._v(" 五、补充")]),t._v(" "),a("h3",{attrs:{id:"_1、group-id-是什么"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、group-id-是什么"}},[t._v("#")]),t._v(" 1、"),a("code",[t._v("Group Id")]),t._v(" 是什么")]),t._v(" "),a("p",[t._v("gradle 中会使用 "),a("code",[t._v("implementation")]),t._v(" 来依赖某个第三方库，结构为："),a("code",[t._v("implementation GroupId:ArtifactId:Version")]),t._v("：")]),t._v(" "),a("blockquote",[a("p",[t._v("比如："),a("code",[t._v("implementation 'com.android.support:appcompat-v7:27.1.1'")])])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("组成部分")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("解释")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("GroupId")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是项目组织的唯一标识符，在实际开发中一般对应 JAVA 的包的结构，就是 main 目录里 java 的目录结构，如 ‘com.android.support’。")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("ArtifactId")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是项目的唯一标识符，在实际开发中一般对应项目的名称，就是项目根目录的名称,例：appcompat-v7。")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("Version")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是项目的版本号，例：1.0-SNAPSHOT 。其中 1.0 是版本号，SNAPSHOT 版本代表不稳定、尚处于开发中的版本。而衍生的有 Release 版本则代表稳定的版本")])])])]),t._v(" "),a("blockquote",[a("p",[t._v("注意：这里说的是 GroupId "),a("code",[t._v("一般")]),t._v(" 对应包结构，也就是说，"),a("code",[t._v("GroupId")]),t._v(" 与 "),a("code",[t._v("包名")]),t._v(" 是可以不一样的。就像 Android 项目里的 "),a("code",[t._v("applicationId")]),t._v(" 跟 "),a("code",[t._v("包名")]),t._v(" 是两个不同的概念一样。")])]),t._v(" "),a("h2",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[t._v("#")]),t._v(" 参考资料")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://xiaozhuanlan.com/topic/6174835029",target:"_blank",rel:"noopener noreferrer"}},[t._v("Android 库发布到 Maven Central 全攻略"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.jianshu.com/p/1c715203c7c6",target:"_blank",rel:"noopener noreferrer"}},[t._v("Android 发布库到 MavenCentral 说明以及踩坑解决"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=n.exports}}]);
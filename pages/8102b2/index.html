<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>AndroidéŸ³è§†é¢‘ - MediaCodecç¼–ç mp4è¸©å‘è®°å½• | FSAå…¨æ ˆè¡ŒåŠ¨</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/img/favicon.ico">
    <script data-ad-client="ca-pub-3568502583266202" async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script src="/js/global.js"></script>
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?885476c2eae58d4aee1ab7fcfb548adb";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
      </script>
    <meta name="description" content="åˆ†äº«Androidã€iOSã€Pythonã€Vueç­‰æŠ€æœ¯èµ„è®¯ã€å­¦ä¹ ç¬”è®°ï¼ŒæˆåŠŸæœ‰æ¢¦æƒ³çš„å…¨æ ˆå·¥ç¨‹å¸ˆï¼Œæ¬¢è¿å…³æ³¨ã€‚">
    <meta name="keywords" content="FSAå…¨æ ˆè¡ŒåŠ¨,LinXunFeng,GitLqr,å…¨æ ˆæŠ€æœ¯åšå®¢,ç§»åŠ¨ç«¯,webå‰ç«¯,åç«¯å¼€å‘,å‰ç«¯æ¡†æ¶,webå‰ç«¯,Androidæ¡†æ¶,iOSæ¡†æ¶,Flutteræ¡†æ¶,Pythonæ¡†æ¶,Vueæ¡†æ¶,æŠ€æœ¯æ–‡æ¡£,å­¦ä¹ ,é¢è¯•,Java,Kotlin,object-c,Swift,Kotlin,Dart,JavaScript,js,ES6,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="code-Cyx4xlZmzI">
    <meta name="google-site-verification" content="_0KO4KbxdSwB-TPRQ8bRqmML8dnrx5G82GhQNZlR4HU">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.f24a96ee.css" as="style"><link rel="preload" href="/assets/js/app.c6bb1e2f.js" as="script"><link rel="preload" href="/assets/js/2.d8b68cf2.js" as="script"><link rel="preload" href="/assets/js/52.3e4c5bd5.js" as="script"><link rel="prefetch" href="/assets/js/10.d73c7d01.js"><link rel="prefetch" href="/assets/js/100.9ebeff21.js"><link rel="prefetch" href="/assets/js/101.692c940a.js"><link rel="prefetch" href="/assets/js/102.e2f371dd.js"><link rel="prefetch" href="/assets/js/103.915d0f88.js"><link rel="prefetch" href="/assets/js/104.28cfb05a.js"><link rel="prefetch" href="/assets/js/105.093417ac.js"><link rel="prefetch" href="/assets/js/106.3cbd2542.js"><link rel="prefetch" href="/assets/js/107.64783dba.js"><link rel="prefetch" href="/assets/js/108.743f1185.js"><link rel="prefetch" href="/assets/js/109.f19942bd.js"><link rel="prefetch" href="/assets/js/11.1bcda3a0.js"><link rel="prefetch" href="/assets/js/110.8af5f48d.js"><link rel="prefetch" href="/assets/js/111.8bd3a603.js"><link rel="prefetch" href="/assets/js/112.561e95e5.js"><link rel="prefetch" href="/assets/js/113.dc4597d6.js"><link rel="prefetch" href="/assets/js/114.0b360344.js"><link rel="prefetch" href="/assets/js/115.d3a84fe4.js"><link rel="prefetch" href="/assets/js/116.3987a675.js"><link rel="prefetch" href="/assets/js/117.06dfe4cf.js"><link rel="prefetch" href="/assets/js/118.2345113b.js"><link rel="prefetch" href="/assets/js/119.33296c42.js"><link rel="prefetch" href="/assets/js/12.9d9f5ba0.js"><link rel="prefetch" href="/assets/js/120.7a1fc0c6.js"><link rel="prefetch" href="/assets/js/121.c39b3bac.js"><link rel="prefetch" href="/assets/js/122.98abc6f1.js"><link rel="prefetch" href="/assets/js/123.d26b6150.js"><link rel="prefetch" href="/assets/js/124.8a5a34f6.js"><link rel="prefetch" href="/assets/js/125.ba32e31d.js"><link rel="prefetch" href="/assets/js/126.5c1160c9.js"><link rel="prefetch" href="/assets/js/127.cda7bc77.js"><link rel="prefetch" href="/assets/js/128.693e08d4.js"><link rel="prefetch" href="/assets/js/129.e6b34ba6.js"><link rel="prefetch" href="/assets/js/13.2af8a90e.js"><link rel="prefetch" href="/assets/js/130.a5c99ad8.js"><link rel="prefetch" href="/assets/js/131.b076989a.js"><link rel="prefetch" href="/assets/js/132.a7a08de6.js"><link rel="prefetch" href="/assets/js/133.d8849bbf.js"><link rel="prefetch" href="/assets/js/134.dcaaac4d.js"><link rel="prefetch" href="/assets/js/135.c6bc7cb3.js"><link rel="prefetch" href="/assets/js/136.33cac26d.js"><link rel="prefetch" href="/assets/js/137.3004ec9e.js"><link rel="prefetch" href="/assets/js/138.ee2729e3.js"><link rel="prefetch" href="/assets/js/139.d863ede2.js"><link rel="prefetch" href="/assets/js/14.dfac8018.js"><link rel="prefetch" href="/assets/js/140.343149a0.js"><link rel="prefetch" href="/assets/js/141.8ebeb156.js"><link rel="prefetch" href="/assets/js/142.0000c560.js"><link rel="prefetch" href="/assets/js/143.858e714b.js"><link rel="prefetch" href="/assets/js/144.03be3e85.js"><link rel="prefetch" href="/assets/js/145.ad942d20.js"><link rel="prefetch" href="/assets/js/146.73bd0120.js"><link rel="prefetch" href="/assets/js/147.7bb47f16.js"><link rel="prefetch" href="/assets/js/148.e68ebbae.js"><link rel="prefetch" href="/assets/js/149.29471e7e.js"><link rel="prefetch" href="/assets/js/15.525d5dfe.js"><link rel="prefetch" href="/assets/js/150.4f7368c0.js"><link rel="prefetch" href="/assets/js/151.266b6326.js"><link rel="prefetch" href="/assets/js/152.81a4a354.js"><link rel="prefetch" href="/assets/js/153.ba1b275c.js"><link rel="prefetch" href="/assets/js/154.d40959f9.js"><link rel="prefetch" href="/assets/js/155.d80b6fb3.js"><link rel="prefetch" href="/assets/js/156.0b6b7dd6.js"><link rel="prefetch" href="/assets/js/157.bb574347.js"><link rel="prefetch" href="/assets/js/158.79568bb0.js"><link rel="prefetch" href="/assets/js/159.834152ab.js"><link rel="prefetch" href="/assets/js/16.d8737ba6.js"><link rel="prefetch" href="/assets/js/160.e38dc458.js"><link rel="prefetch" href="/assets/js/161.7d320e95.js"><link rel="prefetch" href="/assets/js/162.f40b1bf1.js"><link rel="prefetch" href="/assets/js/163.eea7d02c.js"><link rel="prefetch" href="/assets/js/164.301e0ebf.js"><link rel="prefetch" href="/assets/js/165.872058d4.js"><link rel="prefetch" href="/assets/js/166.39e3356b.js"><link rel="prefetch" href="/assets/js/167.c4ab4771.js"><link rel="prefetch" href="/assets/js/168.b754bac3.js"><link rel="prefetch" href="/assets/js/169.112e7c56.js"><link rel="prefetch" href="/assets/js/17.a33331a9.js"><link rel="prefetch" href="/assets/js/170.9c109df8.js"><link rel="prefetch" href="/assets/js/171.b2e89bec.js"><link rel="prefetch" href="/assets/js/172.05885208.js"><link rel="prefetch" href="/assets/js/173.00433726.js"><link rel="prefetch" href="/assets/js/174.03a3e19a.js"><link rel="prefetch" href="/assets/js/175.0f0d16e3.js"><link rel="prefetch" href="/assets/js/176.04e89e1b.js"><link rel="prefetch" href="/assets/js/177.f1a27042.js"><link rel="prefetch" href="/assets/js/178.18b92fd7.js"><link rel="prefetch" href="/assets/js/179.0ba32a94.js"><link rel="prefetch" href="/assets/js/18.33037d59.js"><link rel="prefetch" href="/assets/js/180.1c7ea6dd.js"><link rel="prefetch" href="/assets/js/181.4e1b0e36.js"><link rel="prefetch" href="/assets/js/182.738a0ee8.js"><link rel="prefetch" href="/assets/js/183.72488ed9.js"><link rel="prefetch" href="/assets/js/184.23c2d802.js"><link rel="prefetch" href="/assets/js/185.cdb38eec.js"><link rel="prefetch" href="/assets/js/186.9f92092e.js"><link rel="prefetch" href="/assets/js/187.2d308919.js"><link rel="prefetch" href="/assets/js/188.71b680ea.js"><link rel="prefetch" href="/assets/js/189.484ff586.js"><link rel="prefetch" href="/assets/js/19.c55f5d6a.js"><link rel="prefetch" href="/assets/js/190.23ad8f3c.js"><link rel="prefetch" href="/assets/js/191.e2edad20.js"><link rel="prefetch" href="/assets/js/192.27c76ade.js"><link rel="prefetch" href="/assets/js/193.38e4943d.js"><link rel="prefetch" href="/assets/js/194.cd8a8da1.js"><link rel="prefetch" href="/assets/js/195.22e273b6.js"><link rel="prefetch" href="/assets/js/196.71fe0a9e.js"><link rel="prefetch" href="/assets/js/197.be65bd57.js"><link rel="prefetch" href="/assets/js/198.c492c1ca.js"><link rel="prefetch" href="/assets/js/199.c38e038e.js"><link rel="prefetch" href="/assets/js/20.33fe86db.js"><link rel="prefetch" href="/assets/js/200.6bb5e186.js"><link rel="prefetch" href="/assets/js/201.44df6630.js"><link rel="prefetch" href="/assets/js/202.53eb7fe1.js"><link rel="prefetch" href="/assets/js/203.e31a7cda.js"><link rel="prefetch" href="/assets/js/204.8a3ecae4.js"><link rel="prefetch" href="/assets/js/205.37cf0034.js"><link rel="prefetch" href="/assets/js/206.eefc40cb.js"><link rel="prefetch" href="/assets/js/207.6e42d498.js"><link rel="prefetch" href="/assets/js/208.03b9f640.js"><link rel="prefetch" href="/assets/js/209.5ac9529b.js"><link rel="prefetch" href="/assets/js/21.ab5e7303.js"><link rel="prefetch" href="/assets/js/210.c88480e4.js"><link rel="prefetch" href="/assets/js/211.054f2cf0.js"><link rel="prefetch" href="/assets/js/212.50ab9aaf.js"><link rel="prefetch" href="/assets/js/213.43d3b4a9.js"><link rel="prefetch" href="/assets/js/214.265f5a1f.js"><link rel="prefetch" href="/assets/js/215.7f210b2c.js"><link rel="prefetch" href="/assets/js/216.4a45f69b.js"><link rel="prefetch" href="/assets/js/217.c31f50d9.js"><link rel="prefetch" href="/assets/js/218.85c94d1a.js"><link rel="prefetch" href="/assets/js/219.d3e99fcf.js"><link rel="prefetch" href="/assets/js/22.ec455aec.js"><link rel="prefetch" href="/assets/js/220.4fd2d77c.js"><link rel="prefetch" href="/assets/js/221.f2b1d722.js"><link rel="prefetch" href="/assets/js/222.a543cb0c.js"><link rel="prefetch" href="/assets/js/223.241243e7.js"><link rel="prefetch" href="/assets/js/224.cb80f080.js"><link rel="prefetch" href="/assets/js/225.147ce9aa.js"><link rel="prefetch" href="/assets/js/226.809989e8.js"><link rel="prefetch" href="/assets/js/227.f629406e.js"><link rel="prefetch" href="/assets/js/228.fbd3e64f.js"><link rel="prefetch" href="/assets/js/229.47d90bf2.js"><link rel="prefetch" href="/assets/js/23.d3a842bc.js"><link rel="prefetch" href="/assets/js/230.9c74b873.js"><link rel="prefetch" href="/assets/js/231.59eccfaf.js"><link rel="prefetch" href="/assets/js/232.531f3ddb.js"><link rel="prefetch" href="/assets/js/233.054d629f.js"><link rel="prefetch" href="/assets/js/234.a8c342b3.js"><link rel="prefetch" href="/assets/js/235.70791fa2.js"><link rel="prefetch" href="/assets/js/236.c342e446.js"><link rel="prefetch" href="/assets/js/237.3e90bbcc.js"><link rel="prefetch" href="/assets/js/238.b5e52402.js"><link rel="prefetch" href="/assets/js/239.03006a0d.js"><link rel="prefetch" href="/assets/js/24.39bed4a8.js"><link rel="prefetch" href="/assets/js/240.226fcfeb.js"><link rel="prefetch" href="/assets/js/241.99463975.js"><link rel="prefetch" href="/assets/js/242.8203fcf1.js"><link rel="prefetch" href="/assets/js/243.6357f2d0.js"><link rel="prefetch" href="/assets/js/244.51ff69bb.js"><link rel="prefetch" href="/assets/js/245.2ab7f25f.js"><link rel="prefetch" href="/assets/js/246.a72a8dd3.js"><link rel="prefetch" href="/assets/js/247.407ba8e2.js"><link rel="prefetch" href="/assets/js/248.978ded7d.js"><link rel="prefetch" href="/assets/js/249.e6130c43.js"><link rel="prefetch" href="/assets/js/25.ffefd3d8.js"><link rel="prefetch" href="/assets/js/250.d57e2ed3.js"><link rel="prefetch" href="/assets/js/251.e434eaa5.js"><link rel="prefetch" href="/assets/js/252.2f3e1e1a.js"><link rel="prefetch" href="/assets/js/253.29650a7c.js"><link rel="prefetch" href="/assets/js/254.a391536a.js"><link rel="prefetch" href="/assets/js/255.9ef76f6d.js"><link rel="prefetch" href="/assets/js/256.6d7bf3a6.js"><link rel="prefetch" href="/assets/js/257.09ee44d5.js"><link rel="prefetch" href="/assets/js/258.ea1754e6.js"><link rel="prefetch" href="/assets/js/26.ad30bb86.js"><link rel="prefetch" href="/assets/js/27.dbb4126e.js"><link rel="prefetch" href="/assets/js/28.8bd9d307.js"><link rel="prefetch" href="/assets/js/29.1a71e08e.js"><link rel="prefetch" href="/assets/js/3.9953073e.js"><link rel="prefetch" href="/assets/js/30.42d97bb2.js"><link rel="prefetch" href="/assets/js/31.30f900c9.js"><link rel="prefetch" href="/assets/js/32.e1411055.js"><link rel="prefetch" href="/assets/js/33.3b70ec9e.js"><link rel="prefetch" href="/assets/js/34.bf2570c3.js"><link rel="prefetch" href="/assets/js/35.ac4ccec9.js"><link rel="prefetch" href="/assets/js/36.bffc7c49.js"><link rel="prefetch" href="/assets/js/37.28a9ac42.js"><link rel="prefetch" href="/assets/js/38.9ff8e9d7.js"><link rel="prefetch" href="/assets/js/39.6c873179.js"><link rel="prefetch" href="/assets/js/4.f21084fd.js"><link rel="prefetch" href="/assets/js/40.975b3dc6.js"><link rel="prefetch" href="/assets/js/41.72637e70.js"><link rel="prefetch" href="/assets/js/42.f99b3098.js"><link rel="prefetch" href="/assets/js/43.7b5518fd.js"><link rel="prefetch" href="/assets/js/44.cb0239ea.js"><link rel="prefetch" href="/assets/js/45.411caf2b.js"><link rel="prefetch" href="/assets/js/46.8374a3d1.js"><link rel="prefetch" href="/assets/js/47.79a96a98.js"><link rel="prefetch" href="/assets/js/48.3318facd.js"><link rel="prefetch" href="/assets/js/49.e2fefb42.js"><link rel="prefetch" href="/assets/js/5.fb735bd1.js"><link rel="prefetch" href="/assets/js/50.e41a48f7.js"><link rel="prefetch" href="/assets/js/51.32974ba1.js"><link rel="prefetch" href="/assets/js/53.10b4da3e.js"><link rel="prefetch" href="/assets/js/54.bcf53f23.js"><link rel="prefetch" href="/assets/js/55.7dc849e2.js"><link rel="prefetch" href="/assets/js/56.106c02f7.js"><link rel="prefetch" href="/assets/js/57.024e57ae.js"><link rel="prefetch" href="/assets/js/58.14f76c64.js"><link rel="prefetch" href="/assets/js/59.0b24f777.js"><link rel="prefetch" href="/assets/js/6.95ba2307.js"><link rel="prefetch" href="/assets/js/60.ac9296c1.js"><link rel="prefetch" href="/assets/js/61.ecdd48ba.js"><link rel="prefetch" href="/assets/js/62.db6f90d9.js"><link rel="prefetch" href="/assets/js/63.f15fa795.js"><link rel="prefetch" href="/assets/js/64.a054754c.js"><link rel="prefetch" href="/assets/js/65.8752258b.js"><link rel="prefetch" href="/assets/js/66.98e44e46.js"><link rel="prefetch" href="/assets/js/67.4ec50b75.js"><link rel="prefetch" href="/assets/js/68.c7e0e945.js"><link rel="prefetch" href="/assets/js/69.84d33152.js"><link rel="prefetch" href="/assets/js/7.4ea2a7cb.js"><link rel="prefetch" href="/assets/js/70.3cd7537f.js"><link rel="prefetch" href="/assets/js/71.797b9ba2.js"><link rel="prefetch" href="/assets/js/72.544b7f42.js"><link rel="prefetch" href="/assets/js/73.233ea30b.js"><link rel="prefetch" href="/assets/js/74.74193aec.js"><link rel="prefetch" href="/assets/js/75.58090f19.js"><link rel="prefetch" href="/assets/js/76.70d46d82.js"><link rel="prefetch" href="/assets/js/77.ab758303.js"><link rel="prefetch" href="/assets/js/78.d40627c8.js"><link rel="prefetch" href="/assets/js/79.4a480023.js"><link rel="prefetch" href="/assets/js/8.ade06460.js"><link rel="prefetch" href="/assets/js/80.396cf990.js"><link rel="prefetch" href="/assets/js/81.86cbef81.js"><link rel="prefetch" href="/assets/js/82.70b41659.js"><link rel="prefetch" href="/assets/js/83.5e7d0691.js"><link rel="prefetch" href="/assets/js/84.8141702f.js"><link rel="prefetch" href="/assets/js/85.132eb564.js"><link rel="prefetch" href="/assets/js/86.77c1ef0a.js"><link rel="prefetch" href="/assets/js/87.4ab992e4.js"><link rel="prefetch" href="/assets/js/88.ab381cae.js"><link rel="prefetch" href="/assets/js/89.3fc1949f.js"><link rel="prefetch" href="/assets/js/9.e286e9f3.js"><link rel="prefetch" href="/assets/js/90.95e4cac8.js"><link rel="prefetch" href="/assets/js/91.c5c18896.js"><link rel="prefetch" href="/assets/js/92.5883fb02.js"><link rel="prefetch" href="/assets/js/93.0a36ee68.js"><link rel="prefetch" href="/assets/js/94.71a7723b.js"><link rel="prefetch" href="/assets/js/95.48f02b92.js"><link rel="prefetch" href="/assets/js/96.6f336fcd.js"><link rel="prefetch" href="/assets/js/97.d6a61a44.js"><link rel="prefetch" href="/assets/js/98.8f3aeef7.js"><link rel="prefetch" href="/assets/js/99.76c3493b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f24a96ee.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="ç›®å½•" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210131112211.jpg" alt="FSAå…¨æ ˆè¡ŒåŠ¨" class="logo"> <span class="site-name can-hide">FSAå…¨æ ˆè¡ŒåŠ¨</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç§»åŠ¨ç«¯" class="dropdown-title"><a href="/mobile/" class="link-title">ç§»åŠ¨ç«¯</a> <span class="title" style="display:none;">ç§»åŠ¨ç«¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>ç§»åŠ¨ç«¯æ–‡ç« </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/61d6a8/" class="nav-link">Android</a></li><li class="dropdown-subitem"><a href="/pages/cb27eb/" class="nav-link">iOS</a></li><li class="dropdown-subitem"><a href="/pages/61cc74/" class="nav-link">Flutter</a></li></ul></li><li class="dropdown-item"><h4>å­¦ä¹ ç¬”è®°</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/kotlin/" class="nav-link">ã€ŠKotlinå¿«é€Ÿå…¥é—¨è¿›é˜¶ã€‹ç¬”è®°</a></li><li class="dropdown-subitem"><a href="/note/flutter/" class="nav-link">ã€ŠFlutterä»å…¥é—¨åˆ°å®æˆ˜ã€‹ç¬”è®°</a></li><li class="dropdown-subitem"><a href="/note/flutter/lxf/review/" class="nav-link">ã€ŠFlutterå¤ä¹ ã€‹ç¬”è®°</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/web/" class="nav-link">å‰ç«¯</a></div><div class="nav-item"><a href="/backend/" class="nav-link">åç«¯</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å†…åŠŸå¿ƒæ³•" class="dropdown-title"><a href="/power/" class="link-title">å†…åŠŸå¿ƒæ³•</a> <span class="title" style="display:none;">å†…åŠŸå¿ƒæ³•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>å­¦ä¹ ç¬”è®°</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/designpattern/" class="nav-link">ã€Šæ·±å…¥æµ…å‡ºè®¾è®¡æ¨¡å¼Javaç‰ˆã€‹ç¬”è®°</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ›´å¤š" class="dropdown-title"><a href="/more/" class="link-title">æ›´å¤š</a> <span class="title" style="display:none;">æ›´å¤š</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/ea5b48/" class="nav-link">é€†å‘</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç´¢å¼•" class="dropdown-title"><a href="/archives/" class="link-title">ç´¢å¼•</a> <span class="title" style="display:none;">ç´¢å¼•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">åˆ†ç±»</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">æ ‡ç­¾</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">å½’æ¡£</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="About" class="dropdown-title"><!----> <span class="title" style="display:;">About</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/LinXunFeng/" class="nav-link">LinXunFeng</a></li><li class="dropdown-item"><!----> <a href="/about/GitLqr/" class="nav-link">GitLqr</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210131111432.png"> <div class="blogger-info"><h3>å…¬ä¼—å·ï¼šFSAå…¨æ ˆè¡ŒåŠ¨</h3> <span>è®°å½•å­¦ä¹ è¿‡ç¨‹ä¸­çš„çŸ¥è¯†</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç§»åŠ¨ç«¯" class="dropdown-title"><a href="/mobile/" class="link-title">ç§»åŠ¨ç«¯</a> <span class="title" style="display:none;">ç§»åŠ¨ç«¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>ç§»åŠ¨ç«¯æ–‡ç« </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/61d6a8/" class="nav-link">Android</a></li><li class="dropdown-subitem"><a href="/pages/cb27eb/" class="nav-link">iOS</a></li><li class="dropdown-subitem"><a href="/pages/61cc74/" class="nav-link">Flutter</a></li></ul></li><li class="dropdown-item"><h4>å­¦ä¹ ç¬”è®°</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/kotlin/" class="nav-link">ã€ŠKotlinå¿«é€Ÿå…¥é—¨è¿›é˜¶ã€‹ç¬”è®°</a></li><li class="dropdown-subitem"><a href="/note/flutter/" class="nav-link">ã€ŠFlutterä»å…¥é—¨åˆ°å®æˆ˜ã€‹ç¬”è®°</a></li><li class="dropdown-subitem"><a href="/note/flutter/lxf/review/" class="nav-link">ã€ŠFlutterå¤ä¹ ã€‹ç¬”è®°</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/web/" class="nav-link">å‰ç«¯</a></div><div class="nav-item"><a href="/backend/" class="nav-link">åç«¯</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å†…åŠŸå¿ƒæ³•" class="dropdown-title"><a href="/power/" class="link-title">å†…åŠŸå¿ƒæ³•</a> <span class="title" style="display:none;">å†…åŠŸå¿ƒæ³•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>å­¦ä¹ ç¬”è®°</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/designpattern/" class="nav-link">ã€Šæ·±å…¥æµ…å‡ºè®¾è®¡æ¨¡å¼Javaç‰ˆã€‹ç¬”è®°</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ›´å¤š" class="dropdown-title"><a href="/more/" class="link-title">æ›´å¤š</a> <span class="title" style="display:none;">æ›´å¤š</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/ea5b48/" class="nav-link">é€†å‘</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç´¢å¼•" class="dropdown-title"><a href="/archives/" class="link-title">ç´¢å¼•</a> <span class="title" style="display:none;">ç´¢å¼•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">åˆ†ç±»</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">æ ‡ç­¾</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">å½’æ¡£</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="About" class="dropdown-title"><!----> <span class="title" style="display:;">About</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/LinXunFeng/" class="nav-link">LinXunFeng</a></li><li class="dropdown-item"><!----> <a href="/about/GitLqr/" class="nav-link">GitLqr</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>AndroidUI</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Androidç¬¬ä¸‰æ–¹SDK</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Androidæ··æ·†</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Androidä»“åº“</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Androidæ–°é—»</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Androidç³»ç»Ÿå¼€å‘</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Androidæºç </span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Androidæ³¨è§£AOP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Androidè„šæœ¬</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>AndroidTvå¼€å‘</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>AndroidNDK</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>AndroidéŸ³è§†é¢‘</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/e4ed73/" class="sidebar-link">AndroidéŸ³è§†é¢‘ - Libyuvä½¿ç”¨å®æˆ˜</a></li><li><a href="/pages/8102b2/" aria-current="page" class="active sidebar-link">AndroidéŸ³è§†é¢‘ - MediaCodecç¼–ç mp4è¸©å‘è®°å½•</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/8102b2/#ä¸€ã€å½•åƒå˜è‰²" class="sidebar-link">ä¸€ã€å½•åƒå˜è‰²</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/8102b2/#_1ã€ç°è±¡" class="sidebar-link">1ã€ç°è±¡</a></li><li class="sidebar-sub-header level3"><a href="/pages/8102b2/#_2ã€åˆ†æ" class="sidebar-link">2ã€åˆ†æ</a></li><li class="sidebar-sub-header level3"><a href="/pages/8102b2/#_3ã€å®ç°" class="sidebar-link">3ã€å®ç°</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/8102b2/#äºŒã€å½•åƒæ—¶é•¿ç¼©æ°´-ä¸¢å¸§" class="sidebar-link">äºŒã€å½•åƒæ—¶é•¿ç¼©æ°´ï¼ˆä¸¢å¸§ï¼‰</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/8102b2/#_1ã€ç°è±¡-2" class="sidebar-link">1ã€ç°è±¡</a></li><li class="sidebar-sub-header level3"><a href="/pages/8102b2/#_2ã€åˆ†æ-2" class="sidebar-link">2ã€åˆ†æ</a></li><li class="sidebar-sub-header level3"><a href="/pages/8102b2/#_3ã€å®ç°-2" class="sidebar-link">3ã€å®ç°</a></li><li class="sidebar-sub-header level3"><a href="/pages/8102b2/#_4ã€ä¿®è¡¥" class="sidebar-link">4ã€ä¿®è¡¥</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Androidçƒ­ä¿®å¤</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Androidæ€§èƒ½ä¼˜åŒ–</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Androidäº‘æ¸¸æˆ</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Androidæ’ä»¶åŒ–</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>iOSUI</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>iOSå·¥å…·</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>iOSåº•å±‚åŸç†ä¸åº”ç”¨</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>iOSç»„ä»¶åŒ–</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>iOSéŸ³è§†é¢‘</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>iOSç–‘éš¾æ‚ç—‡</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>iOSä¹‹Swift</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>iOSä¹‹RxSwift</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>iOSå¼€æºé¡¹ç›®</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>iOSé€†å‘</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Flutterå¼€å‘</span> <span class="arrow right"></span></p> <!----></section></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- æ­£æ–¹å½¢ -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="é¦–é¡µ" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/mobile/#ç§»åŠ¨ç«¯" data-v-06225672>ç§»åŠ¨ç«¯</a></li><li data-v-06225672><a href="/mobile/#AndroidéŸ³è§†é¢‘" data-v-06225672>AndroidéŸ³è§†é¢‘</a></li></ul> <div class="info" data-v-06225672><div title="ä½œè€…" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/GitLqr" target="_blank" title="ä½œè€…" class="beLink" data-v-06225672>GitLqr</a></div> <div title="åˆ›å»ºæ—¶é—´" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2021-06-10</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">ç›®å½•</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">AndroidéŸ³è§†é¢‘ - MediaCodecç¼–ç mp4è¸©å‘è®°å½•<!----></h1> <div class="page-slot page-slot-top"><!-- å›ºå®š100% * 90pxå¯æ˜¾ç¤ºï¼Œmax-height:90pxæœªè§æ˜¾ç¤º-->
     <ins class="adsbygoogle"
          style="display:inline-block;width:100%;max-height:90px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6625304284"></ins>
      <center>æ¬¢è¿å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ï¼š<a href="https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/FSA_QR_bottom.png">[FSAå…¨æ ˆè¡ŒåŠ¨ ğŸ‘‹]</a><center>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="theme-vdoing-content content__default"><p>é¡¹ç›®éœ€è¦åœ¨ä½ç«¯ Android è®¾å¤‡ä¸Šé©±åŠ¨ç›¸æœºè·å– YUV å›¾åƒï¼ŒåŒæ—¶ï¼Œè¿˜éœ€è¦è¿›è¡Œå½•åƒï¼ŒYUV å›¾åƒçš„è·å–ä¸å¤„ç†ä¹‹å‰å·²ç»è¶Ÿè¿‡å»äº†ï¼Œæ€»ä½“æ„Ÿè§‰åªè¦æŒæ¡äº†ç›¸æœºä¸ YUV åŸç†ç­‰çŸ¥è¯†ç‚¹åï¼Œç»“åˆ libyuv è¿™ä¸ªç‰›é€¼çš„åº“åŸºæœ¬å°±æ²¡ä»€ä¹ˆäº†ï¼Œè€Œå½•åƒè¿™ä¸€å—åˆ™æ˜¯ä½¿ç”¨ <code>MediaCodec + MediaMuxer</code> æ¥å¤„ç†ï¼Œæœ¬ç¯‡å°±æ˜¯æˆ‘åœ¨ä½¿ç”¨åŸç”Ÿ <code>MediaCodec</code> ç¼–ç  mp4 æ–‡ä»¶çš„è¸©æ­è®°è¦ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š</p> <ul><li>å½•åƒå˜è‰² (video wrong color)</li> <li>å½•åƒæ—¶é•¿ç¼©æ°´ï¼ˆplay too fastï¼‰</li></ul> <blockquote><p>æ³¨ï¼šä½ç«¯çš„ Android è®¾å¤‡ç¡¬ä»¶æ¡ä»¶æœ‰å¤šå·®å‘¢ï¼Ÿå¤§æ¦‚å°±æ˜¯ 2014 å¹´ Android4.x æ‰‹æœºé‚£ç§æ°´å¹³å§ï¼ŒCPU å¤„ç†é€Ÿåº¦å¾ˆæ„Ÿäººï¼Œå¯¹æ­¤ï¼Œå”¯æœ‰ç¡¬ç¼–ç æ‰æ˜¯ç‹é“ã€‚</p></blockquote> <h2 id="ä¸€ã€å½•åƒå˜è‰²"><a href="#ä¸€ã€å½•åƒå˜è‰²" class="header-anchor">#</a> ä¸€ã€å½•åƒå˜è‰²</h2> <p>åœ¨æ¢ç©¶è¯¥é—®é¢˜å‰ï¼Œå…ˆæ¥äº†è§£ä¸€ä¸‹ <code>MediaCodec</code> çš„ä¸¤ç§ç¼–ç æ¨¡å¼ï¼š</p> <ul><li><code>ByteBuffer æ¨¡å¼</code>ï¼ˆæ‰‹åŠ¨æ¡£ï¼‰ï¼š
<ul><li>æ ¼å¼ï¼š<code>COLOR_FORMAT</code> å¯¹åº”çš„å€¼æ˜¯ <code>MediaCodecInfo.CodecCapabilities.COLOR_FormatYUV420SemiPlanar</code>(å›¾åƒæ ¼å¼ NV21)ã€‚</li> <li>æ“ä½œï¼šé€šè¿‡ <code>MediaCodec.dequeueInputBuffer()</code> è·å–æ•°æ®è¾“å…¥ç¼“å†²åŒºï¼Œå†é€šè¿‡ <code>MediaCodec.queueInputBuffer()</code> æ‰‹åŠ¨å°† YUV å›¾åƒä¼ ç»™ <code>MediaCodec</code>ã€‚</li></ul></li> <li><code>Surface æ¨¡å¼</code>ï¼ˆè‡ªåŠ¨æ¡£ï¼‰:
<ul><li>æ ¼å¼ï¼š<code>COLOR_FORMAT</code> å¯¹åº”çš„å€¼æ˜¯ <code>MediaCodecInfo.CodecCapabilities.COLOR_FormatSurface</code>ã€‚</li> <li>æ“ä½œï¼šé€šè¿‡ <code>MediaCodec.createInputSurface()</code> åˆ›å»ºç¼–ç æ•°æ®æº Surfaceï¼Œå†é€šè¿‡ OpenGL çº¹ç†ï¼Œå°†ç›¸æœºé¢„è§ˆå›¾åƒç»˜åˆ¶åˆ°è¯¥ Surface ä¸Šã€‚</li></ul></li></ul> <h3 id="_1ã€ç°è±¡"><a href="#_1ã€ç°è±¡" class="header-anchor">#</a> 1ã€ç°è±¡</h3> <p>ç›¸æœºé¢„è§ˆæ­£å¸¸ï¼Œä½†æ˜¯å½•åˆ¶å‡ºæ¥çš„ mp4 è§†é¢‘é¢œè‰²å¾ˆé˜´é—´ã€‚</p> <blockquote><p>è¯´æ˜ï¼šå°±è·Ÿ YUV å›¾åƒæŠŠ u/v é¢ å€’ä¹‹åçš„æ•ˆæœä¸€æ ·ã€‚</p></blockquote> <h3 id="_2ã€åˆ†æ"><a href="#_2ã€åˆ†æ" class="header-anchor">#</a> 2ã€åˆ†æ</h3> <p><code>ByteBuffer æ¨¡å¼</code> ä¸‹ï¼Œä»ç›¸æœºå¤„è·å–åˆ°åŸå§‹çš„ NV21 å›¾åƒï¼Œäº¤ç»™è®¾ç½®äº† <code>COLOR_FORMAT</code> ä¸º <code>COLOR_FormatYUV420SemiPlanar</code> çš„ <code>MediaCodec</code>ï¼Œç»“æœåœ¨ä¸åŒçš„ Android è®¾å¤‡ä¸Šï¼Œæœ‰çš„æ­£å¸¸ï¼Œæœ‰çš„ä¸æ­£å¸¸ï¼ˆå°‘æ•°ï¼‰ï¼Œåˆšå¼€å§‹ä»¥ä¸ºæ˜¯ä¸ªåˆ«è®¾å¤‡ä¸Šä¸æ”¯æŒè¿™ç§ <code>COLOR_FORMAT</code>ï¼Œä½†äº‹å®å¹¶éå¦‚æ­¤ã€‚stackoverflow æŸä¸ªæ­ªæœä»å¯¹æ­¤é—®é¢˜çš„è§£é‡Šå¦‚ä¸‹ï¼š</p> <div class="language-PlainText extra-class"><pre class="language-plaintext"><code>The YUV formats used by Camera output and MediaCodec input have their U/V planes swapped.

If you are able to move the data through a Surface you can avoid this issue; however, you lose the ability to examine the YUV data. An example of recording to a .mp4 file from a camera can be found on bigflake.

Some details about the colorspaces and how to swap them is in this answer.

...
</code></pre></div><blockquote><p>æ³¨ï¼šstackoverflow æ–‡ç« é“¾æ¥ï¼š<a href="https://stackoverflow.com/questions/19915962/android-mediacodec-video-wrong-color-and-playing-too-fast" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/19915962/android-mediacodec-video-wrong-color-and-playing-too-fast<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>æ‰€ä»¥è¯´ï¼Œè¿™æ˜¯ <code>MediaCodec</code> æœ¬èº«çš„ bugï¼Œå®ƒè‡ªå·±ä¼šå¯¹è¾“å…¥çš„ YUV å›¾åƒçš„ u/v è¿›è¡Œäº¤æ¢ï¼Œè§£å†³çš„æ–¹æ¡ˆæœ‰ 2 ç§ï¼š</p> <ul><li>ä½¿ç”¨ <code>ByteBuffer æ¨¡å¼</code>ï¼Œåœ¨æŠŠ NV21 å›¾åƒä¼ ç»™ <code>MediaCodec</code> ä¹‹å‰ï¼Œå…ˆæŠŠ NV21 è½¬æˆ NV12ï¼ˆæ¯•ç«Ÿè¿™ä¿©è´§ä»…ä»…åªæ˜¯ u/v ç›¸åè€Œå·²ï¼‰ï¼Œä½†å‰é¢å·²ç»æåˆ°äº†ï¼Œåªæ˜¯å°‘æ•°è®¾å¤‡ä¼šæœ‰è¿™ç§æƒ…å†µï¼Œé€‚é…èµ·æ¥ä¼°è®¡æœ‰å¤Ÿå‘›çš„ã€‚<code>ä¸æ¨è</code></li> <li>ä½¿ç”¨ <code>Surface æ¨¡å¼</code>ï¼Œå¯ä»¥å®Œç¾é¿å…è¿™ç§æƒ…å†µï¼Œä½†åŒæ—¶ä¼šä¸§å¤±å¯¹åŸ YUV å›¾åƒçš„å¤„ç†èƒ½åŠ›ï¼Œä¸è¿‡å¯ä»¥ä½¿ç”¨ OpenGL æ–¹å¼æ¥å¤„ç†å›¾åƒã€‚<code>æ¨è</code></li></ul> <h3 id="_3ã€å®ç°"><a href="#_3ã€å®ç°" class="header-anchor">#</a> 3ã€å®ç°</h3> <p>å¤§è‡´æ­¥éª¤å¦‚ä¸‹ï¼š</p> <ul><li>ä¸€æ–¹é¢ï¼Œä½¿ç”¨ OpenGL çº¹ç†åˆ›å»ºçº¹ç†ï¼Œå¹¶åŒ…è£…ä¸º SurfaceTexture ç»™ç›¸æœºä½œä¸º preview çª—å£ï¼Œè¿™æ ·ç›¸æœºå›¾åƒå°±ä¼šå‘ˆç°åœ¨çº¹ç†ä¸Šã€‚</li> <li>å¦ä¸€æ–¹é¢ï¼Œä½¿ç”¨ <code>mMediaCodec.createInputSurface()</code> ä½œä¸º MediaCodec çš„ç¼–ç æ•°æ®æºã€‚</li> <li>æœ€åï¼Œåœ¨ç›¸æœºé¢„è§ˆçš„åŒæ—¶ï¼Œè®©çº¹ç†ä¸Šçš„å›¾åƒç»˜åˆ¶åˆ° <code>inputSurface</code>ã€‚</li></ul> <blockquote><p>è¯´æ˜ï¼šCamera ---&gt; TextureId(OpenGL) ---&gt; InputSurface(MediaCodec)</p></blockquote> <p>å…·ä½“å®ç°å¯ä»¥åœ¨ bigflake çš„ Demo(CameraToMpegTest) ä¸­è·å–ï¼š<a href="https://www.bigflake.com/mediacodec/CameraToMpegTest.java.txt" target="_blank" rel="noopener noreferrer">https://www.bigflake.com/mediacodec/CameraToMpegTest.java.txt<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="äºŒã€å½•åƒæ—¶é•¿ç¼©æ°´-ä¸¢å¸§"><a href="#äºŒã€å½•åƒæ—¶é•¿ç¼©æ°´-ä¸¢å¸§" class="header-anchor">#</a> äºŒã€å½•åƒæ—¶é•¿ç¼©æ°´ï¼ˆä¸¢å¸§ï¼‰</h2> <p>è§£å†³è¯¥é—®é¢˜æœ‰ä¸¤ä¸ªå…³é”®ï¼š</p> <ul><li>æ—¶é—´æˆ³å¯¹é½ï¼š
<ul><li><code>ByteBuffer æ¨¡å¼</code>ï¼šé€šè¿‡ <code>MediaCodec.queueInputBuffer()</code> æ‰‹åŠ¨å°† YUV å›¾åƒä¼ ç»™ <code>MediaCodec</code> çš„åŒæ—¶ï¼Œéœ€è¦ä¼ é€’å½“å‰çš„æ—¶é—´æˆ³ï¼Œæ³¨æ„æ—¶é—´å•ä½æ˜¯å¾®ç§’(us)ã€‚</li> <li><code>Surface æ¨¡å¼</code>ï¼šé€šè¿‡ <code>MediaCodec.createInputSurface()</code> åˆ›å»ºå‡ºæ¥çš„ inputSurfaceï¼Œä¼šæœ‰ä¸ä¹‹å¯¹æ¯”çš„ <code>mEGLDisplayã€mEGLSurface</code>ï¼Œåœ¨æ‰§è¡Œ <code>EGL14.eglSwapBuffers(mEGLDisplay, mEGLSurface)</code> ä¹‹å‰ï¼Œé€šè¿‡ <code>EGLExt.eglPresentationTimeANDROID(mEGLDisplay, mEGLSurface, nsecs)</code> å¯¹ MediaCodec çš„ inputSurface çš„æ•°æ®è®¾ç½®æ—¶é—´æˆ³ã€‚</li></ul></li> <li>åª’ä½“æ ¼å¼é…ç½®ï¼š
<ul><li><code>MediaFormat</code> çš„å…³é”®å¸§é—´éš”(KEY_I_FRAME_INTERVAL) ä¸ å¸§ç‡(KEY_FRAME_RATE) å¿…é¡»é…ç½®å¾—å½“ã€‚</li></ul></li></ul> <blockquote><p>è¯´æ˜ï¼šè¿™é‡Œæ˜¯æ ¸å¿ƒæ€»ç»“ï¼Œå¯å…ˆè·³è¿‡å¾€ä¸‹çœ‹ï¼Œä¹‹åå†å›è¿‡å¤´æ¥çœ‹ï¼Œä¼šæ¯”è¾ƒå¥½ç†è§£ã€‚</p></blockquote> <h3 id="_1ã€ç°è±¡-2"><a href="#_1ã€ç°è±¡-2" class="header-anchor">#</a> 1ã€ç°è±¡</h3> <p>å½•åˆ¶ä¸€æ®µ 10s çš„è§†é¢‘ï¼Œä»è®¾å¤‡ä¸Šæå–å‡ºæ¥åï¼Œä½¿ç”¨æ’­æ”¾å™¨æ’­æ”¾è§‚å¯Ÿã€‚å‘ç°æœ‰çš„è®¾å¤‡æ­£å¸¸ï¼Œä¸ªåˆ«è®¾å¤‡å½•åˆ¶å‡ºæ¥çš„è§†é¢‘ï¼Œæ—¶é•¿ä»…ä»…åªæœ‰ä¸€åŠï¼Œè¿™ä¹Ÿå°±æ˜¯ç½‘ä¸Šéƒ½åœ¨è¯´çš„ <code>play too fast</code> é—®é¢˜ã€‚</p> <blockquote><p>å®‰åˆ©ï¼š<code>OnlyStopWatch_x64.exe</code> è¿™æ˜¯ä¸€ä¸ªè®¡æ—¶å™¨å°å·¥å…·ï¼Œå¯¹äºè§†é¢‘å½•åˆ¶ã€ç›´æ’­è¿™ç§éœ€è¦è§‚å¯Ÿæ—¶é—´å¿«æ…¢çš„åœºæ™¯å¾ˆå®ç”¨ã€‚ç”»é¢ä¸¢å¤±ã€æ’­æ”¾å¤ªå¿«ç­‰é—®é¢˜ï¼Œéƒ½å¾ˆå®¹æ˜“çœ‹å‡ºæ¥ã€‚</p></blockquote> <h3 id="_2ã€åˆ†æ-2"><a href="#_2ã€åˆ†æ-2" class="header-anchor">#</a> 2ã€åˆ†æ</h3> <p>å‰é¢æåˆ°çš„ stackoverflow é—®ç­”ä¸­ï¼Œé‚£ä¸ªæ­ªæœä»åŒæ—¶ä¹Ÿè¡¨è¾¾äº†ä»–å¯¹ <code>ä½¿ç”¨MediaCodecå½•åˆ¶å‡ºæ¥çš„è§†é¢‘æ’­æ”¾å¤ªå¿«</code> è¿™ä¸ªé—®é¢˜çš„è§£é‡Šï¼š</p> <div class="language-PlainText extra-class"><pre class="language-plaintext"><code>...

There is no timestamp information in the raw H.264 elementary stream. You need to pass the timestamp through the decoder to MediaMuxer or whatever you're using to create your final output. If you don't, the player will just pick a rate, or possibly play the frames as fast as it can.
</code></pre></div><blockquote><p>æ³¨ï¼šstackoverflow æ–‡ç« é“¾æ¥ï¼š<a href="https://stackoverflow.com/questions/19915962/android-mediacodec-video-wrong-color-and-playing-too-fast" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/19915962/android-mediacodec-video-wrong-color-and-playing-too-fast<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>ä»–è®¤ä¸º H.264 ä¸åŒ…å«æ—¶é—´æˆ³ä¿¡æ¯ï¼Œä½ éœ€è¦æŠŠæ—¶é—´æˆ³é€šè¿‡ç¼–ç å™¨(MediaCodec)ç»™åˆ°åª’ä½“å¤ç”¨å™¨(MediaMuxer)ï¼Œå¦åˆ™ï¼Œæ’­æ”¾å™¨ä¼šé€‰æ‹©ä¸€ä¸ªé€Ÿç‡ï¼Œå°½å¿«åœ°æ’­æ”¾å¸§ã€‚</p> <h3 id="_3ã€å®ç°-2"><a href="#_3ã€å®ç°-2" class="header-anchor">#</a> 3ã€å®ç°</h3> <p>å¦‚æœæ˜¯ <code>ByteBuffer æ¨¡å¼</code>ï¼Œåˆ™æ ¸å¿ƒä»£ç å®ç°å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">feedMediaCodecData</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isEncoderStart<span class="token punctuation">)</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> bufferIndex <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        bufferIndex <span class="token operator">=</span> mMediaCodec<span class="token punctuation">.</span><span class="token function">dequeueInputBuffer</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IllegalStateException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>bufferIndex <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ByteBuffer</span> buffer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Build</span><span class="token punctuation">.</span><span class="token constant">VERSION</span><span class="token punctuation">.</span><span class="token constant">SDK_INT</span> <span class="token operator">&gt;=</span> <span class="token class-name">Build</span><span class="token punctuation">.</span><span class="token constant">VERSION_CODES</span><span class="token punctuation">.</span><span class="token constant">LOLLIPOP</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                buffer <span class="token operator">=</span> mMediaCodec<span class="token punctuation">.</span><span class="token function">getInputBuffer</span><span class="token punctuation">(</span>bufferIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>inputBuffers <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                buffer <span class="token operator">=</span> inputBuffers<span class="token punctuation">[</span>bufferIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>buffer <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            buffer<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            buffer<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            buffer<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// çº³ç§’(ns) è½¬ å¾®ç§’(us)</span>
            mMediaCodec<span class="token punctuation">.</span><span class="token function">queueInputBuffer</span><span class="token punctuation">(</span>bufferIndex<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>length<span class="token punctuation">,</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token class-name">MediaCodec</span><span class="token punctuation">.</span><span class="token constant">BUFFER_FLAG_KEY_FRAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™æ—¶è¦æ³¨æ„ï¼Œ<code>MediaCodec</code> éœ€è¦çš„æ—¶é—´å•ä½æ˜¯å¾®ç§’(us)ï¼Œå¦‚æœä½ ä¸ä½¿ç”¨æ­£ç¡®çš„æ—¶é—´ï¼Œå¯èƒ½ä¼šå‡ºé—®é¢˜ï¼Œæ¯”å¦‚ï¼š<a href="https://stackoverflow.com/questions/20475332/mediacodec-h264-encoder-not-working-on-snapdragon-800-devices" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/20475332/mediacodec-h264-encoder-not-working-on-snapdragon-800-devices<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>è¡¥å……ï¼šç§’(s)ã€æ¯«ç§’(ms)ã€å¾®ç§’(us)ã€çº³ç§’(ns)ï¼Œä¹‹é—´çš„æ¯”ä¾‹éƒ½æ˜¯ 1:1000ã€‚</p></blockquote> <p>å¦‚æœæ˜¯ <code>Surface æ¨¡å¼</code>ï¼Œåˆ™æ ¸å¿ƒä»£ç å®ç°å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// æ›´æ–°çº¹ç†å›¾åƒ</span>
<span class="token comment">// Acquire a new frame of input, and render it to the Surface.  If we had a GLSurfaceView we could switch EGL contexts and call drawImage() a second time to render it on screen.  The texture can be shared between contexts by passing the GLSurfaceView's EGLContext as eglCreateContext()'s share_context argument.</span>
mSurfaceTexture<span class="token punctuation">.</span><span class="token function">updateTexImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mSurfaceTexture<span class="token punctuation">.</span><span class="token function">getTransformMatrix</span><span class="token punctuation">(</span>mSTMatrix<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ä¼ å…¥æ—¶é—´æˆ³ä¿¡æ¯</span>
<span class="token comment">// Set the presentation time stamp from the SurfaceTexture's time stamp.  This will be used by MediaMuxer to set the PTS in the video.</span>
mInputSurface<span class="token punctuation">.</span><span class="token function">setPresentationTime</span><span class="token punctuation">(</span>mSurfaceTexture<span class="token punctuation">.</span><span class="token function">getTimestamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Submit it to the encoder.  The eglSwapBuffers call will block if the input is full, which would be bad if it stayed full until we dequeued an output buffer (which we can't do, since we're stuck here).  So long as we fully drain the encoder before supplying additional input, the system guarantees that we can supply another frame without blocking.</span>
mInputSurface<span class="token punctuation">.</span><span class="token function">swapBuffers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å…·ä½“å®ç°å¯ä»¥åœ¨ bigflake çš„ Demo(CameraToMpegTest) ä¸­è·å–ï¼š<a href="https://www.bigflake.com/mediacodec/CameraToMpegTest.java.txt" target="_blank" rel="noopener noreferrer">https://www.bigflake.com/mediacodec/CameraToMpegTest.java.txt<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="_4ã€ä¿®è¡¥"><a href="#_4ã€ä¿®è¡¥" class="header-anchor">#</a> 4ã€ä¿®è¡¥</h3> <p>å°½ç®¡æŒ‰ç…§ä¸Šé¢çš„æ­¥éª¤ï¼ŒæŠŠæ—¶é—´æˆ³æ­£ç¡®ä¼ é€’ç»™ <code>MediaMuxer</code> äº†ï¼Œä½†ä¾æ—§æ— æµäºäº‹ã€‚ç»è¿‡å°†æˆ‘é¡¹ç›®ä¸­çš„ä»£ç ä¸ bigflake çš„ CameraToMpegTest ä¸­çš„ä»£ç è¿›è¡Œå¯¹æ¯”ï¼Œå‘ç°ï¼Œ<code>MediaFormat</code> çš„é…ç½®ä¸Šä¹Ÿå¾ˆå…³é”®ï¼Œå¿…é¡»é…ç½®å¾—å½“ï¼Œå¦åˆ™ä¹Ÿè¿˜æ˜¯ä¼šå‡ºç°æ—¶é•¿ç¼©æ°´çš„é—®é¢˜ï¼Œäºæ˜¯æˆ‘å°†åŸæ¥é¡¹ç›®ä¸­çš„ä»£ç è¿›è¡Œä¿®æ”¹ï¼Œå°†å¸§ç‡ä¿®æ”¹ä¸º 30fï¼Œå…³é”®å¸§é—´è·æ”¹ä¸º 5sï¼Œä¸¢å¸§çš„é—®é¢˜è¿™æ‰è§£å†³äº†ï¼Œ<code>MediaFormat</code> é…ç½®å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">MIME_TYPE</span> <span class="token operator">=</span> <span class="token string">&quot;video/avc&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">FRAME_INTERVAL</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">// é—´éš”5sæ’å…¥ä¸€å¸§å…³é”®å¸§</span>
<span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">FRAME_RATE</span> <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
<span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">float</span> <span class="token constant">BPP</span> <span class="token operator">=</span> <span class="token number">0.50f</span><span class="token punctuation">;</span>
<span class="token keyword">protected</span> <span class="token keyword">int</span> mColorFormat <span class="token operator">=</span> <span class="token class-name">MediaCodecInfo<span class="token punctuation">.</span>CodecCapabilities<span class="token punctuation">.</span>COLOR_FormatSurface</span><span class="token punctuation">;</span>

<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">initMediaCodec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">final</span> <span class="token class-name">MediaFormat</span> format <span class="token operator">=</span> <span class="token class-name">MediaFormat</span><span class="token punctuation">.</span><span class="token function">createVideoFormat</span><span class="token punctuation">(</span><span class="token constant">MIME_TYPE</span><span class="token punctuation">,</span> mWidth<span class="token punctuation">,</span> mHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
    format<span class="token punctuation">.</span><span class="token function">setInteger</span><span class="token punctuation">(</span><span class="token class-name">MediaFormat</span><span class="token punctuation">.</span><span class="token constant">KEY_COLOR_FORMAT</span><span class="token punctuation">,</span> mColorFormat<span class="token punctuation">)</span><span class="token punctuation">;</span>
    format<span class="token punctuation">.</span><span class="token function">setInteger</span><span class="token punctuation">(</span><span class="token class-name">MediaFormat</span><span class="token punctuation">.</span><span class="token constant">KEY_BIT_RATE</span><span class="token punctuation">,</span> <span class="token function">calcBitRate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    format<span class="token punctuation">.</span><span class="token function">setInteger</span><span class="token punctuation">(</span><span class="token class-name">MediaFormat</span><span class="token punctuation">.</span><span class="token constant">KEY_FRAME_RATE</span><span class="token punctuation">,</span> <span class="token constant">FRAME_RATE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    format<span class="token punctuation">.</span><span class="token function">setInteger</span><span class="token punctuation">(</span><span class="token class-name">MediaFormat</span><span class="token punctuation">.</span><span class="token constant">KEY_I_FRAME_INTERVAL</span><span class="token punctuation">,</span> <span class="token constant">FRAME_INTERVAL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        mMediaCodec <span class="token operator">=</span> <span class="token class-name">MediaCodec</span><span class="token punctuation">.</span><span class="token function">createEncoderByType</span><span class="token punctuation">(</span><span class="token constant">MIME_TYPE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    mMediaCodec<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span>format<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name">MediaCodec</span><span class="token punctuation">.</span><span class="token constant">CONFIGURE_FLAG_ENCODE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// get Surface for encoder input</span>
    <span class="token comment">// this method only can call between #configure and #start</span>
    <span class="token comment">// API &gt;= 18</span>
    mSurface <span class="token operator">=</span> mMediaCodec<span class="token punctuation">.</span><span class="token function">createInputSurface</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    mMediaCodec<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">protected</span> <span class="token keyword">int</span> <span class="token function">calcBitRate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">final</span> <span class="token keyword">int</span> bitrate <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token constant">BPP</span> <span class="token operator">*</span> <span class="token constant">FRAME_RATE</span> <span class="token operator">*</span> mWidth <span class="token operator">*</span> mHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;bitrate=%5.2f[Mbps]&quot;</span><span class="token punctuation">,</span> bitrate <span class="token operator">/</span> <span class="token number">1024f</span> <span class="token operator">/</span> <span class="token number">1024f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> bitrate<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¦å¤–ï¼Œäº²æµ‹åªè¦ <code>MediaFormat</code> é…ç½®æ²¡é—®é¢˜ï¼Œå°±ç®—æ—¶é—´æˆ³ä¸ä¼ é€’ä¹Ÿæ²¡å½±å“ï¼Œemmm...ï¼Œæ—¢ç„¶æ—¶é—´æˆ³çš„ä»£ç å·²ç»å†™å¥½äº†ï¼Œåˆæš‚æ—¶æ²¡å‡ºç°å…¶ä»–å‘ï¼Œä¸ºäº†å®‰å…¨èµ·è§ï¼Œè¿˜æ˜¯æŠŠæ—¶é—´æˆ³ä¿¡æ¯å¸¦ä¸Šå§ã€‚</p></div></div> <div class="page-slot page-slot-bottom"><!-- æ¨ªå‘è‡ªé€‚åº” -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <center><img style="width:100%;" src="https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/FSA_QR_bottom.png"/></center>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=%E9%9F%B3%E8%A7%86%E9%A2%91" title="æ ‡ç­¾">#éŸ³è§†é¢‘</a><a href="/tags/?tag=MediaCodec" title="æ ‡ç­¾">#MediaCodec</a></div> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">2025/08/10, 08:41:48</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/e4ed73/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">AndroidéŸ³è§†é¢‘ - Libyuvä½¿ç”¨å®æˆ˜</div></a> <a href="/pages/ccf9c0/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">çƒ­ä¿®å¤ä¸æ’ä»¶åŒ–åŸºç¡€ - dexä¸class</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/pages/e4ed73/" class="prev">AndroidéŸ³è§†é¢‘ - Libyuvä½¿ç”¨å®æˆ˜</a></span> <span class="next"><a href="/pages/ccf9c0/">çƒ­ä¿®å¤ä¸æ’ä»¶åŒ–åŸºç¡€ - dexä¸class</a>â†’
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">æœ€è¿‘æ›´æ–°</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/bf0a83/"><div>
            Flutter - ä½¿ç”¨æœ¬åœ° DevTools éªŒè¯ SVGåŠ è½½ä¼˜åŒ–
            <!----></div></a> <span class="date">08-07</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/cfaaca/"><div>
            AI - Gemini CLI æ‘†è„±ç»ˆç«¯é™åˆ¶
            <!----></div></a> <span class="date">07-27</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/305cd9/"><div>
            Flutter - èŠå¤©é¢æ¿åº“åŠ¨ç”»ç”Ÿç¡¬ï¼Ÿè¿™æ¬¡è®©ä½ ä¸æ»‘ä¸ªå¤Ÿ
            <!----></div></a> <span class="date">07-20</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">æ›´å¤šæ–‡ç« &gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="https://github.com/LinXunFeng" title="GitHub for LinXunFeng" target="_blank" class="iconfont icon-githubsquare"></a><a href="mailto:linxunfeng@yeah.net" title="email for LinXunFeng" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/GitLqr" title="GitHub for GitLqr" target="_blank" class="iconfont icon-github-circle"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="æœ¬ç«™ä¸»é¢˜">Vdoing</a> 
    | Copyright Â© 2020-2025
    <span><a href="/about" target="_blank">FSAå…¨æ ˆè¡ŒåŠ¨</a></span></div> <div class="buttons"><div title="è¿”å›é¡¶éƒ¨" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="å»è¯„è®º" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ä¸»é¢˜æ¨¡å¼" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          è·Ÿéšç³»ç»Ÿ
        </li><li class="iconfont icon-rijianmoshi">
          æµ…è‰²æ¨¡å¼
        </li><li class="iconfont icon-yejianmoshi">
          æ·±è‰²æ¨¡å¼
        </li><li class="iconfont icon-yuedu">
          é˜…è¯»æ¨¡å¼
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><span class="close-but">Ã—</span> <div><!-- å›ºå®š160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;max-width:160px;max-height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c6bb1e2f.js" defer></script><script src="/assets/js/2.d8b68cf2.js" defer></script><script src="/assets/js/52.3e4c5bd5.js" defer></script>
  </body>
</html>

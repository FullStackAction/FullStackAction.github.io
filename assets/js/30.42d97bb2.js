(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{440:function(t,a,s){"use strict";s.r(a);var n=s(21),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"一、简述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、简述"}},[t._v("#")]),t._v(" 一、简述")]),t._v(" "),a("p",[t._v("目前（Android/java） "),a("code",[t._v("library")]),t._v(" 的主要发布仓库有 "),a("code",[t._v("MavenCentral")]),t._v(" 和 "),a("code",[t._v("jitpack")]),t._v("，我之前也对这两种仓库的发布流程做了详细介绍：")]),t._v(" "),a("ul",[a("li",[t._v("发布至 MavenCentral: "),a("a",{attrs:{href:"https://juejin.cn/post/6953598441817636900",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://juejin.cn/post/6953598441817636900"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("发布至 jitpack: "),a("a",{attrs:{href:"https://juejin.cn/post/7040733114506674183#heading-8",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://juejin.cn/post/7040733114506674183#heading-8"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("但是，以上两种仓库，一般是用来免费发布开源 "),a("code",[t._v("library")]),t._v(" 的，在提交库信息时，就会要求填写开源仓库的 url，如果我们不想开源源代码，仅仅只是希望把混淆后的 "),a("code",[t._v("aar/jar")]),t._v(" 发布出去，那么上述两篇文章的流程就行不通了。")]),t._v(" "),a("p",[t._v("一般来说，这些平台也会提供付费服务，支持发布闭源的 "),a("code",[t._v("library")]),t._v("，就比如 "),a("code",[t._v("jitpack")]),t._v(" 付费之后，才可以导入私有的 GitHub 仓库（即 "),a("code",[t._v("private repo")]),t._v("），从而构建并发布闭源的 "),a("code",[t._v("library")]),t._v("，可这笔费用不低的，具体费用见官网说明：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("jitpack")]),t._v(" 官网："),a("a",{attrs:{href:"https://jitpack.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://jitpack.io/"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("code",[t._v("jitpack")]),t._v(" 付费价格："),a("a",{attrs:{href:"https://jitpack.io/private#subscribe",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://jitpack.io/private#subscribe"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("那有没有办法做到，既能免费又能闭源地发布 "),a("code",[t._v("library")]),t._v(" 呢？Yes，这就是本篇要讲述的主要内容，灰常实用。")]),t._v(" "),a("h2",{attrs:{id:"二、创建-library"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、创建-library"}},[t._v("#")]),t._v(" 二、创建 library")]),t._v(" "),a("blockquote",[a("p",[t._v("温馨提示：这里只是举个简单的例子，熟悉 Android library 的朋友可以直接跳到下一节。")])]),t._v(" "),a("p",[t._v("不管是 "),a("code",[t._v("jar")]),t._v(" 还是 "),a("code",[t._v("aar")]),t._v("，对于 Android 开发者来说，都是 "),a("code",[t._v("library")]),t._v("，只是它们的 module 类型不同而已，简单来说，"),a("code",[t._v("aar")]),t._v(" 是可以包含资源文件的 "),a("code",[t._v("jar")]),t._v("，功能更加强大，这里以 "),a("code",[t._v("aar")]),t._v(" 为例，创建一个 android library module：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20230813121546/image/202406231546160.jpg",alt:""}})]),t._v(" "),a("p",[t._v("为了新手容易理解，这里有几点简单说明一下：")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("com.android.library")]),t._v("：是 android library module 使用的 Gradle 插件，"),a("code",[t._v("android {}")]),t._v(" 是该插件的配置项，最终产出的库文件是 "),a("code",[t._v("*.aar")]),t._v("。")]),t._v(" "),a("li",[a("code",[t._v("minifyEnabled")]),t._v("：是否开启混淆，默认为 false。")]),t._v(" "),a("li",[a("code",[t._v("proguard-rules.pro")]),t._v("：当前 library 编译时的混淆规则（"),a("code",[t._v("minifyEnabled")]),t._v(" 为 "),a("code",[t._v("true")]),t._v(" 时生效），对生成最终的 aar 文件有影响。")]),t._v(" "),a("li",[a("code",[t._v("consumer-rules.pro")]),t._v("：携带在 aar 文件中的混淆规则，对 别人工程 编译时的混淆规则有影响。")])]),t._v(" "),a("blockquote",[a("p",[t._v("注：java library module 使用的 Gradle 插件是 "),a("code",[t._v("java-library")]),t._v("（"),a("code",[t._v("apply plugin: 'java-library'")]),t._v("），没有 "),a("code",[t._v("android{}")]),t._v(" 配置项，如需混淆，则需要依赖其他 Gradle 插件，有需要的可以看我之前写的另一篇文章。"),a("br"),t._v("Android - 混淆 java-library 工程："),a("a",{attrs:{href:"https://juejin.cn/post/7174443107298050061",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://juejin.cn/post/7174443107298050061"),a("OutboundLink")],1)])]),t._v(" "),a("div",{staticClass:"language-gradle extra-class"},[a("pre",{pre:!0,attrs:{class:"language-gradle"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// build.gradle")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("apply")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("plugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'com.android.library'")]),t._v("\n\nandroid "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n\n    defaultConfig "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n        versionCode "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n        versionName "),a("span",{pre:!0,attrs:{class:"token interpolation-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0"')])]),t._v("\n        consumerProguardFiles "),a("span",{pre:!0,attrs:{class:"token interpolation-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"consumer-rules.pro"')])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    buildTypes "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        release "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            minifyEnabled "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 开启混淆")]),t._v("\n            proguardFiles "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getDefaultProguardFile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'proguard-android-optimize.txt'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'proguard-rules.pro'")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("dependencies")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implementation")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'androidx.appcompat:appcompat:1.2.0'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implementation")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'com.google.android.material:material:1.1.0'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implementation")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'com.luffykou:android-common-utils:1.1.3'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("这里我创建的 "),a("code",[t._v("library")]),t._v(" 功能非常简单，可以将一个图片 Bitmap 转成 Base64 字符串：")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * GitLqr 工具类\n *\n * @author LQR\n * @since 2024/6/22\n */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("GitLqrUtil")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * bitmap 转 base64\n     */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bitmapToBase64")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Bitmap")]),t._v(" bitmap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Base64")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("encodeToString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bitmapToByte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bitmap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Base64")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DEFAULT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * bitmap 转 byte[]\n     */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bitmapToByte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Bitmap")]),t._v(" bitmap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ByteArrayOutputStream")]),t._v(" o "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ByteArrayOutputStream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        bitmap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("compress")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Bitmap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CompressFormat")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PNG")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" o"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" o"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toByteArray")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("现在就可以编译 "),a("code",[t._v("library")]),t._v(" 生成 "),a("code",[t._v("aar")]),t._v(" 文件了，找到在 AS 右侧的 Gradle 面板，点开后找到 "),a("code",[t._v("library")]),t._v(" 下的 "),a("code",[t._v("assembleXXX")]),t._v(" task，这里我需要生成混淆后的 "),a("code",[t._v("aar")]),t._v(" 文件，所以执行 "),a("code",[t._v("assembleRelease")]),t._v("，最终产物在 module 的 "),a("code",[t._v("build/outputs/aar")]),t._v(" 目录下：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20230813121546/image/202406231547923.jpg",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"三、发布本地-maven"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、发布本地-maven"}},[t._v("#")]),t._v(" 三、发布本地 maven")]),t._v(" "),a("p",[t._v("因为 "),a("code",[t._v("aar")]),t._v(" 文件中只包含当前 "),a("code",[t._v("library")]),t._v(" 的代码和资源，其依赖的第三方库不会被合并进去，想要被其他工程正常集成使用，就需要将第三方库的依赖信息传递下去，所以，需要借助 maven 发布插件，生成 "),a("code",[t._v("pom")]),t._v(" 文件，因为 "),a("code",[t._v("maven")]),t._v(" 插件已经过时，这里我使用的是 "),a("code",[t._v("maven-publish")]),t._v(" 插件，"),a("code",[t._v("library")]),t._v(" 脚本配置如下：")]),t._v(" "),a("div",{staticClass:"language-gradle extra-class"},[a("pre",{pre:!0,attrs:{class:"language-gradle"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("apply")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("plugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'com.android.library'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("apply")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("plugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'maven-publish'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" LIB_VERSION_CODE "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" LIB_VERSION_NAME "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token interpolation-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0"')])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" LIB_GROUP_ID "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'com.gitlqr'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" LIB_ARTIFACT_ID "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'closed_source_arr'")]),t._v("\n\nandroid "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n    defaultConfig "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n        versionCode LIB_VERSION_CODE\n        versionName LIB_VERSION_NAME\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将当前module打包发布到本地maven仓库")]),t._v("\nafterEvaluate "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    publishing "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置maven 仓库")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("repositories")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// build/outputs/maven_repo")]),t._v("\n            maven "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" url "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("uri")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("new "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("File")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("buildDir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token interpolation-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"outputs/maven_repo"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置发布产物")]),t._v("\n        publications "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("maven")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MavenPublication"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 容器可配置的信息 MavenPublication")]),t._v("\n                groupId LIB_GROUP_ID\n                artifactId LIB_ARTIFACT_ID\n                version LIB_VERSION_NAME\n\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 注：AGP 3.6.0 及以上才能使用，作用是将 Android Gradle 插件生成的组件，作为发布的内容")]),t._v("\n                from components"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("release\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("如果 "),a("code",[t._v("library")]),t._v(" 使用的 AGP 版本低于 3.6.0，"),a("code",[t._v("maven-publish")]),t._v(" 的配置会比较麻烦，具体脚本配置如下：")]),t._v(" "),a("div",{staticClass:"language-gradle extra-class"},[a("pre",{pre:!0,attrs:{class:"language-gradle"}},[a("code",[t._v("task "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sourceJar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Jar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    from android"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sourceSets")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("srcDirs\n    classifier "),a("span",{pre:!0,attrs:{class:"token interpolation-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sources"')])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将当前module打包发布到本地maven仓库")]),t._v("\nafterEvaluate "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    publishing "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置maven 仓库")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("repositories")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// build/outputs/maven_repo")]),t._v("\n            maven "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" url "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("uri")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("new "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("File")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("buildDir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token interpolation-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"outputs/maven_repo"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置发布产物")]),t._v("\n        publications "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("maven")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MavenPublication"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 容器可配置的信息 MavenPublication")]),t._v("\n                groupId LIB_GROUP_ID\n                artifactId LIB_ARTIFACT_ID\n                version LIB_VERSION_NAME\n\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置上传源码")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("artifact")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sourceJar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 指定生成的aar路径")]),t._v("\n                artifact "),a("span",{pre:!0,attrs:{class:"token interpolation-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("$")]),a("span",{pre:!0,attrs:{class:"token expression"}},[t._v("buildDir")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("/outputs/aar/")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),a("span",{pre:!0,attrs:{class:"token expression"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("project")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name")]),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('-release.aar"')])]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// pom文件中声明依赖，从而传递到使用方")]),t._v("\n                pom"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("withXml "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" dependenciesNode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("asNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dependencies'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 必要的传递性依赖")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" coreDependencies "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'api'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'implementation'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n                    coreDependencies"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("each "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" dependency "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("\n                        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" config "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" configurations"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("dependency"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n                        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token interpolation-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lqr configurations = ')]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),a("span",{pre:!0,attrs:{class:"token expression"}},[t._v("config")]),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v(", class = ")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),a("span",{pre:!0,attrs:{class:"token expression"}},[t._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("class")]),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 提取每种传递性依赖配置中，依赖的第三方库信息")]),t._v("\n                        config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("allDependencies"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("each "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" dependencyNode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" dependenciesNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dependency'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                            dependencyNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'groupId'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" it"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("group"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                            dependencyNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'artifactId'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" it"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                            dependencyNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'version'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" it"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("version"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// dependencyNode.appendNode('scope', dependency)")]),t._v("\n                        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ul",[a("li",[t._v("Android 上传库 官方文档："),a("a",{attrs:{href:"https://developer.android.com/build/publish-library/upload-library?hl=zh-cn",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://developer.android.com/build/publish-library/upload-library?hl=zh-cn"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("maven 插件 和 maven-publish 插件的区别："),a("a",{attrs:{href:"https://juejin.cn/post/7017608469901475847",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://juejin.cn/post/7017608469901475847"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("配置完成 maven 插件后，Gradle 面板会多出来 "),a("code",[t._v("publishing")]),t._v(" 任务组，双击 "),a("code",[t._v("publish")]),t._v(" 任务，即可在指定的本地目录下，生成 maven 相关的文件，其中 "),a("code",[t._v("pom")]),t._v(" 文件非常重要，可以看到它的 "),a("code",[t._v("<dependencies>")]),t._v(" 节点下，声明了 "),a("code",[t._v("library")]),t._v(" 依赖的所有第三方库信息：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20230813121546/image/202406231547093.jpg",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"四、发布-jitpack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、发布-jitpack"}},[t._v("#")]),t._v(" 四、发布 jitpack")]),t._v(" "),a("p",[t._v("好了，现在 "),a("code",[t._v("aar")]),t._v(" 和 "),a("code",[t._v("pom")]),t._v(" 文件都有了，接下来就可以着手发布到 "),a("code",[t._v("jitpack")]),t._v(" 了。")]),t._v(" "),a("blockquote",[a("p",[t._v("温馨提示：当前 "),a("code",[t._v("pom")]),t._v(" 文件非最终版本，下面的步骤，不要边看边操作，一定等完整看完之后再做操作哦~")])]),t._v(" "),a("h3",{attrs:{id:"_1、创建仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、创建仓库"}},[t._v("#")]),t._v(" 1、创建仓库")]),t._v(" "),a("p",[t._v("首先，需要创建一个空白的 GitHub 仓库（名字随便），然后把 "),a("code",[t._v("aar")]),t._v(" 和 "),a("code",[t._v("pom")]),t._v(" 文件上传上去：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20230813121546/image/202406231548462.jpg",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("注："),a("code",[t._v("pom.xml")]),t._v(" 就是上面使用 maven 插件生成出来的 "),a("code",[t._v("closed_source_arr-1.0.pom")]),t._v(" 文件，我把它名字改了而已。")])]),t._v(" "),a("p",[t._v("可以看到，仓库中我多上传了一个 "),a("code",[t._v("jitpack.yml")]),t._v(" 文件，这个文件的作用是，让 "),a("code",[t._v("jitpack")]),t._v(" 直接使用我们提供的 "),a("code",[t._v("aar")]),t._v(" 和 "),a("code",[t._v("pom")]),t._v(" 文件，不需要它来生成，具体内容如下：")]),t._v(" "),a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("install")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(' FILE="'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Dfile=closed_source_arr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v('1.0.aar"\n  '),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" mvn install"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("install"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("file $FILE "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("DgroupId=com.gitlqr "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("DartifactId=closed_source_arr "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Dversion=1.0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Dpackaging=aar "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("DpomFile=pom.xml\n")])])]),a("blockquote",[a("p",[t._v("注："),a("code",[t._v("jitpack.yml")]),t._v(" 文件中的参数（"),a("code",[t._v("file")]),t._v("、"),a("code",[t._v("groupId")]),t._v("、"),a("code",[t._v("artifactId")]),t._v("、"),a("code",[t._v("version")]),t._v("）根据你的库来修改，不能照抄的！参数名很好理解，相信修改起来没有任何难度。")])]),t._v(" "),a("h3",{attrs:{id:"_2、创建-release"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、创建-release"}},[t._v("#")]),t._v(" 2、创建 release")]),t._v(" "),a("p",[t._v("给刚刚提交的记录打个 "),a("code",[t._v("tag")]),t._v("，并且基于这个 "),a("code",[t._v("tag")]),t._v(" 发布一个 "),a("code",[t._v("release")]),t._v("：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20230813121546/image/202406231548896.jpg",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("注：因为 "),a("code",[t._v("jitpack")]),t._v(" 会以 "),a("code",[t._v("release")]),t._v(" 的名字作为版本号，所以，建议最好跟 "),a("code",[t._v("aar")]),t._v(" 的版本号一致。")])]),t._v(" "),a("h3",{attrs:{id:"_3、构建版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、构建版本"}},[t._v("#")]),t._v(" 3、构建版本")]),t._v(" "),a("p",[t._v("来到 "),a("a",{attrs:{href:"https://jitpack.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://jitpack.io/"),a("OutboundLink")],1),t._v("，将 GitHub 仓库链接拷贝到输入框，点击 "),a("code",[t._v("Look up")]),t._v(" 按钮：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20230813121546/image/202406231549118.jpg",alt:""}})]),t._v(" "),a("p",[t._v("可以看到，刚刚打的 "),a("code",[t._v("release")]),t._v(" 被识别到了，但是此时 Log 那一列下面没有日志图标，说明 "),a("code",[t._v("jitpack")]),t._v(" 还没有对它进行构建，点一下 "),a("code",[t._v("Get it")]),t._v(" 按钮，再 "),a("code",[t._v("Look up")]),t._v(" 一下就触发构建了：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20230813121546/image/202406231549366.jpg",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("注：就算不点 "),a("code",[t._v("Get it")]),t._v(" 按钮，"),a("code",[t._v("jitpack")]),t._v(" 也会自动触发构建的，但不知道会延迟多久，反正你想马上构建的话，就点一下吧。")])]),t._v(" "),a("p",[t._v("因为我们已经提供了 "),a("code",[t._v("aar")]),t._v(" 和"),a("code",[t._v("pom")]),t._v(" 文件，所以 "),a("code",[t._v("jitpack")]),t._v(" 构建会很快，1 分钟左右就出来了，但是这次日志图标是红色的，后面是 "),a("code",[t._v("Report")]),t._v(" 按钮，说明构建失败了：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20230813121546/image/202406231549287.jpg",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("注："),a("code",[t._v("Status")]),t._v(" 下方按钮后面有个 × 图标，如果你自己操作的时候没有看到的话，请确认是否有登录 "),a("code",[t._v("jitpack")]),t._v(" 账号。")])]),t._v(" "),a("p",[t._v("点击日志图标，可以查看日志信息：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20230813121546/image/202406231550884.jpg",alt:""}})]),t._v(" "),a("p",[t._v("可以看到报错信息是 "),a("code",[t._v("ERROR: No build artifacts found")]),t._v("，这个报错是因为我们上传的 "),a("code",[t._v("aar")]),t._v(" 和 "),a("code",[t._v("pom")]),t._v(" 文件没有存放到 "),a("code",[t._v("$HOME/.m2/repository")]),t._v(" 等标准目录下，所以 "),a("code",[t._v("jitpack")]),t._v(" 找不到了。不过，可以给 "),a("code",[t._v("pom")]),t._v(" 文件中声明构建时使用 "),a("code",[t._v("android-maven-plugin")]),t._v(" 插件来解决：")]),t._v(" "),a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token prolog"}},[t._v('<?xml version="1.0" encoding="UTF-8"?>')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("project")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  ...\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("packaging")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("aar"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("packaging")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("plugins")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("plugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("com.simpligility.maven.plugins"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("android-maven-plugin"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("4.1.0"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("extensions")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("true"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("extensions")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("configuration")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("encoding")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("utf8"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("encoding")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("source")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1.8"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("source")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("target")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1.8"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("target")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("sign")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("debug")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("false"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("debug")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("sign")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("configuration")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("plugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("plugins")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependencies")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    ...\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependencies")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("project")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("ul",[a("li",[t._v("最终 "),a("code",[t._v("pom")]),t._v(" 文件内容："),a("a",{attrs:{href:"https://github.com/GitLqr/lib-closed-source-arr/blob/main/pom.xml",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/GitLqr/lib-closed-source-arr/blob/main/pom.xml"),a("OutboundLink")],1)])]),t._v(" "),a("p",[a("code",[t._v("pom.xml")]),t._v(" 修改好之后，提交到 GitHub 仓库，然后，执行以下两个步骤：")]),t._v(" "),a("ol",[a("li",[t._v("把前面创建的 "),a("code",[t._v("release")]),t._v(" 和 "),a("code",[t._v("tag")]),t._v(" 都删掉，重新走第二步，即重新打 "),a("code",[t._v("tag")]),t._v(" 和 "),a("code",[t._v("release")]),t._v("。")]),t._v(" "),a("li",[t._v("在 "),a("code",[t._v("jitpack")]),t._v(" 页面，点击 "),a("code",[t._v("Status")]),t._v(" 下方按钮后面的 × 图标，将构建失败的记录删除，重新走第三步，即重新触发构建。")])]),t._v(" "),a("p",[t._v("这次日志图标是绿色的，说明构造成功了：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20230813121546/image/202406231550729.jpg",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"五、集成闭源-library"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、集成闭源-library"}},[t._v("#")]),t._v(" 五、集成闭源 library")]),t._v(" "),a("p",[t._v("点击 "),a("code",[t._v("Get it")]),t._v(" 按钮后，页面会向下滚动，按照 "),a("code",[t._v("jitpack")]),t._v(" 的集成步骤，操作即可：")]),t._v(" "),a("div",{staticClass:"language-gradle extra-class"},[a("pre",{pre:!0,attrs:{class:"language-gradle"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// root build.gradle")]),t._v("\nallprojects "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("repositories")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n        maven "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" url "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://jitpack.io'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// app build.gradle")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("dependencies")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// implementation project(":library")')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implementation")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'com.github.GitLqr:lib-closed-source-arr:1.0'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("工程 rebuild 之后，能正常跑，查看 "),a("code",[t._v("GitLqrUtil")]),t._v(" 类的引用，确实来自闭源 "),a("code",[t._v("aar")]),t._v("：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource20230813121546/image/202406231550360.jpg",alt:""}})]),t._v(" "),a("p",[t._v("至此，闭源的 "),a("code",[t._v("aar")]),t._v(" 就发布成功咯，如果你觉得文章对你有帮助的话，请不吝点个免费的赞~")])])}),[],!1,null,null,null);a.default=e.exports}}]);
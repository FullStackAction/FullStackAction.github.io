(window.webpackJsonp=window.webpackJsonp||[]).push([[89],{435:function(t,a,e){"use strict";e.r(a);var s=e(15),n=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("blockquote",[a("p",[t._v("经过前两篇文章的学习，相信对组件化开发有了大致的了解，那我们这篇文章就来讲讲资源文件的加载吧")])]),t._v(" "),a("p",[t._v("这里我新建了一个LXFMain组件库，主要是用来显示TabBar的玩意，然后再进行组件化抽离出来，其中的过程这里不再赘述，还没了解过的同学建议先阅读下这两篇文章吧")]),t._v(" "),a("p",[a("RouterLink",{attrs:{to:"/pages/d4ac48/"}},[t._v("iOS-组件化开发（一）：远程私有库的基本使用")])],1),t._v(" "),a("p",[a("RouterLink",{attrs:{to:"/pages/9f1d21/"}},[t._v("iOS-组件化开发（二）：远程私有库的更新与子库")])],1),t._v(" "),a("p",[t._v("这里跟之前不一样的地方在于多了图片资源，组件的核心代码放在Classes文件夹中，而图片我们则存放于Assets目录下，如图所示")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205601.png",alt:"存放位置"}})]),t._v(" "),a("h3",{attrs:{id:"一、修改spec"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、修改spec"}},[t._v("#")]),t._v(" 一、修改Spec")]),t._v(" "),a("p",[t._v("将关于资源加载的注释去掉")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("s.resource_bundles = {\n # 'LXFMain' => ['LXFMain/Assets/*.png']\n 'LXFMain' => ['LXFMain/Assets/*']\n}\n")])])]),a("p",[t._v("回到LXFMain的模板库，我们进行一次本地的安装和测试("),a("code",[t._v("pod install")]),t._v(")")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205615.png",alt:""}})]),t._v(" "),a("p",[t._v("可以看到，图片资源也安装进来了，但是运行的效果如下图，图片并不能成功加载出来")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205629.png",alt:"没有图标"}})]),t._v(" "),a("h2",{attrs:{id:"二、修改加载资源代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、修改加载资源代码"}},[t._v("#")]),t._v(" 二、修改加载资源代码")]),t._v(" "),a("p",[t._v("这是当前加载图片的相关代码")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('[UIImage imageNamed:@"图片名称"];\n')])])]),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205648.png",alt:"show in finder"}})]),t._v(" "),a("p",[t._v("右击显示包内容")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205658.png",alt:"LXFMain.framework"}})]),t._v(" "),a("p",[t._v("图片就在这个"),a("code",[t._v("LXFMain.bundle")]),t._v("里面(这里就不截图看了)，这里主要是让大家对这个目录结构有个了解")]),t._v(" "),a("p",[t._v("我们对"),a("code",[t._v("imageNamed")]),t._v("进行跳转到定义操作")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205708.png",alt:"imageNamed"}})]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// load from main bundle\n")])])]),a("p",[t._v("可以看到，官方注释着"),a("code",[t._v("imageNamed")]),t._v("加载的是main bundle中的资源,mainBundle的位置如下图")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205725.png",alt:"mainBundle"}})]),t._v(" "),a("p",[t._v("这样当然就无法加载到图片啦，我们需要让它加载自己当前所在bundle里的图片 ，所以加载图片的代码需要进行修改")]),t._v(" "),a("div",{staticClass:"language-objc extra-class"},[a("pre",{pre:!0,attrs:{class:"language-objc"}},[a("code",[t._v("NSString "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("normalImgName "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('@"个人@2x.png"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nNSBundle "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("curBundle "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("NSBundle bundleForClass"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("self")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("class"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取当前bundle")]),t._v("\nNSString "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("normalImgPath "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("curBundle pathForResource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("normalImgName ofType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("nil inDirectory"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('@"LXFMain.bundle"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nUIImage "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("normalImage "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("UIImage imageWithContentsOfFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("normalImgPath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("但是直接写"),a("code",[t._v("LXFMain.bundle")]),t._v("并不好，不可控，所以还需要改进一下：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('NSString *normalImgName = [NSString stringWithFormat:@"%@@2x.png", normalImg];\nNSBundle *curBundle = [NSBundle bundleForClass:self.class];\n//  *********** 重点 ***********   //\nNSString *curBundleName = curBundle.infoDictionary[@"CFBundleName"];\nNSString *curBundleDirectory = [NSString stringWithFormat:@"%@.bundle", curBundleName];\nNSString *normalImgPath = [curBundle pathForResource:normalImgName ofType:nil inDirectory:curBundleDirectory];\n//  ***************************   //\nUIImage *normalImage = [UIImage imageWithContentsOfFile:normalImgPath];\n')])])]),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205736.png",alt:"成功加载"}})]),t._v(" "),a("h2",{attrs:{id:"三、聊聊xib"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、聊聊xib"}},[t._v("#")]),t._v(" 三、聊聊xib")]),t._v(" "),a("p",[t._v("Xib的加载也是如此")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('NSBundle *curBundle = [NSBundle bundleForClass:self.class];\nLXFCenterView *centerView = (LXFCenterView *)[curBundle loadNibNamed:@"LXFCenterView" owner:nil options:nil].firstObject;\ncenterView.frame = CGRectMake(30, 140, 200, 100);\n[self.view addSubview:centerView];\n')])])]),a("p",[t._v("不过xib中值得一提的是，如果是直接在xib中拖入一个imageView控件来设置图片的加载，我们则需要在图片名字前加上当前bundle名称")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("LXFMain.bundle/个人\n")])])]),a("p",[t._v("这里除了当前xib要加载的图片不属于mainBundle这个原因之外，还有一点就是xib文件与bundle存放位置属于同一级别，故直接使用相对路径的方式，在图片名字前加上bundle名称即可。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205746.png",alt:"同一目录级别"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205758.png",alt:"xib上的操作"}})]),t._v(" "),a("p",[t._v("虽然无法在xib上直接看到效果，不过确实是有效的\n"),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210110205808.png",alt:"xib成功显示图片"}})]),t._v(" "),a("h2",{attrs:{id:"四、遇到的小问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、遇到的小问题"}},[t._v("#")]),t._v(" 四、遇到的小问题")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("[!] Unable to find a pod with name, author, summary, or description matching `lxfmain`\n")])])]),a("p",[t._v("我做完一切操作后发现搜索报上面那个错，解决方案是删除本地索引文件，然后再搜索一遍，系统会自动帮你再生成一切本地索引文件，然后就搞定了～")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("rm -rf ~/Library/Caches/CocoaPods/search_index.json \npod search lxfmain\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{463:function(t,_,v){"use strict";v.r(_);var s=v(21),a=Object(s.a)({},(function(){var t=this,_=t._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h2",{attrs:{id:"一、dex-class-浅析"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#一、dex-class-浅析"}},[t._v("#")]),t._v(" 一、dex/class 浅析")]),t._v(" "),_("h3",{attrs:{id:"_1、class-与-dex-对比"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_1、class-与-dex-对比"}},[t._v("#")]),t._v(" 1、class 与 dex 对比")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("类型")]),t._v(" "),_("th",[t._v("class 文件")]),t._v(" "),_("th",[t._v("dex 文件")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("定义")]),t._v(" "),_("td",[t._v("能够被 jvm 识别、加载并执行的文件格式")]),t._v(" "),_("td",[t._v("能够被 dvm 识别、加载并执行的文件格式")])]),t._v(" "),_("tr",[_("td",[t._v("如何生成")]),t._v(" "),_("td",[t._v("使用 java 命令（javac）")]),t._v(" "),_("td",[t._v("使用 java 命令、dx 命令")])]),t._v(" "),_("tr",[_("td",[t._v("作用")]),t._v(" "),_("td",[t._v("记录一个类文件的所有信息")]),t._v(" "),_("td",[t._v("记录整个工程中所有类文件的信息")])])])]),t._v(" "),_("h3",{attrs:{id:"_2、生成-class-与-dex-文件的指令"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2、生成-class-与-dex-文件的指令"}},[t._v("#")]),t._v(" 2、生成 class 与 dex 文件的指令")]),t._v(" "),_("p",[t._v("生成并运行 class 文件对于我们而言实在太熟悉了，这里只演示 dex 文件的生成与运行。")]),t._v(" "),_("p",[t._v("以 Hello World 为例：")]),t._v(" "),_("div",{staticClass:"language-java extra-class"},[_("pre",{pre:!0,attrs:{class:"language-java"}},[_("code",[_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Hello")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),_("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),_("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),_("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),_("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello LQR!"')]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),_("h4",{attrs:{id:"_1-生成-dex-文件"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_1-生成-dex-文件"}},[t._v("#")]),t._v(" 1）生成 dex 文件")]),t._v(" "),_("blockquote",[_("p",[t._v("生成 dex 文件需要用到 dx 指令，与 java 指令一样，也是对应一个对应的程序来执行的，最好配置到环境变量中，具体可看文章末尾。")])]),t._v(" "),_("p",[t._v("生成 dex 文件之前需要先生成 class 文件，所需指令如下：")]),t._v(" "),_("div",{staticClass:"language-java extra-class"},[_("pre",{pre:!0,attrs:{class:"language-java"}},[_("code",[t._v("javac "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("target "),_("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.6")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("source "),_("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.6")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Hello")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("java\ndx "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("dex "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v(" output "),_("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Hello")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dex "),_("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Hello")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v("\n")])])]),_("p",[_("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210105231835.png",alt:""}})]),t._v(" "),_("h4",{attrs:{id:"_2-运行-dex-文件"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-运行-dex-文件"}},[t._v("#")]),t._v(" 2）运行 dex 文件")]),t._v(" "),_("p",[t._v("class 文件的运行需要依赖 jvm，同理，dex 文件的运行需要依赖 dvm，所以 dex 文件需要在 Android 上才能运行。所需指令如下：")]),t._v(" "),_("div",{staticClass:"language-java extra-class"},[_("pre",{pre:!0,attrs:{class:"language-java"}},[_("code",[t._v("adb push "),_("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Hello")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dex "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("storage"),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("emulated"),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),_("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\nadb shell\ndalvikvm "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cp "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("sdcard"),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),_("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Hello")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dex "),_("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Hello")]),t._v("\n")])])]),_("p",[t._v("使用 adb 将 dex 文件放送到 Android 手机的 SD 卡目录之后，再使用 adb 进入 shell，运行 dvm 指令即可。")]),t._v(" "),_("p",[_("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210105231851.png",alt:""}})]),t._v(" "),_("h2",{attrs:{id:"二、class-文件结构深入"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#二、class-文件结构深入"}},[t._v("#")]),t._v(" 二、class 文件结构深入")]),t._v(" "),_("h3",{attrs:{id:"_1、class-文件结构"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_1、class-文件结构"}},[t._v("#")]),t._v(" 1、class 文件结构：")]),t._v(" "),_("ul",[_("li",[t._v("一种 8 位字节的二进制流文件")]),t._v(" "),_("li",[t._v("各个数据按顺序紧密的排列，无间隙")]),t._v(" "),_("li",[t._v("每个类或接口都单独占据一个 class 文件")])]),t._v(" "),_("h3",{attrs:{id:"_2、class-文件结构的详解"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2、class-文件结构的详解"}},[t._v("#")]),t._v(" 2、class 文件结构的详解：")]),t._v(" "),_("p",[t._v("一个 class 文件，包含下面表格的所有字段，")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("类型")]),t._v(" "),_("th",[t._v("名称")]),t._v(" "),_("th",[t._v("数量")]),t._v(" "),_("th",[t._v("说明")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("u4")]),t._v(" "),_("td",[t._v("magic")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("魔数，0xCAFEBAB")])]),t._v(" "),_("tr",[_("td",[t._v("u2")]),t._v(" "),_("td",[t._v("minor_version")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("次版本号")])]),t._v(" "),_("tr",[_("td",[t._v("u2")]),t._v(" "),_("td",[t._v("major_version")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("主版本号")])]),t._v(" "),_("tr",[_("td",[t._v("u2")]),t._v(" "),_("td",[t._v("constant_pool_count")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("常量池中常量个数")])]),t._v(" "),_("tr",[_("td",[t._v("cp_info")]),t._v(" "),_("td",[t._v("constant_pool")]),t._v(" "),_("td",[t._v("constant_pool_count-1")]),t._v(" "),_("td",[t._v("表类型数据集合，即常量池中每一项常量都是一个表，共有 11 种结构各不相同的表结构数据")])]),t._v(" "),_("tr",[_("td",[t._v("u2")]),t._v(" "),_("td",[t._v("access_flags")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("访问标志，用于识别类或接口层次的访问信息")])]),t._v(" "),_("tr",[_("td",[t._v("u2")]),t._v(" "),_("td",[t._v("this_class")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("类索引，用于确定这个类的全限定名")])]),t._v(" "),_("tr",[_("td",[t._v("u2")]),t._v(" "),_("td",[t._v("super_class")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("父类索引，用于确定这个类父类的全限定名")])]),t._v(" "),_("tr",[_("td",[t._v("u2")]),t._v(" "),_("td",[t._v("interfaces_count")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("接口索引计数器")])]),t._v(" "),_("tr",[_("td",[t._v("u2")]),t._v(" "),_("td",[t._v("interfaces")]),t._v(" "),_("td",[t._v("interfaces_count")]),t._v(" "),_("td",[t._v("接口索引集合，用来描述这个类实现了哪些接口")])]),t._v(" "),_("tr",[_("td",[t._v("u2")]),t._v(" "),_("td",[t._v("fields_count")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("字段表计数器，即字段表集合中的字段表数据个数")])]),t._v(" "),_("tr",[_("td",[t._v("field_info")]),t._v(" "),_("td",[t._v("fields")]),t._v(" "),_("td",[t._v("fields_count")]),t._v(" "),_("td",[t._v("字段表集合，用于描述接口或类中声明的变量，包括类级别（static）和实例级别变量，不包括在方法内部声明的变量")])]),t._v(" "),_("tr",[_("td",[t._v("u2")]),t._v(" "),_("td",[t._v("methods_count")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("方法表计数器，即方法表集合中的方法表数据个数")])]),t._v(" "),_("tr",[_("td",[t._v("method_info")]),t._v(" "),_("td",[t._v("methods")]),t._v(" "),_("td",[t._v("methods_count")]),t._v(" "),_("td",[t._v("方法表集合，方法表结构和字段表结构一样")])]),t._v(" "),_("tr",[_("td",[t._v("u2")]),t._v(" "),_("td",[t._v("attributes_count")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("属性订数器")])]),t._v(" "),_("tr",[_("td",[t._v("attribute_info")]),t._v(" "),_("td",[t._v("attributes")]),t._v(" "),_("td",[t._v("attributes_count")]),t._v(" "),_("td",[t._v("在 Class 文件、属性表、方法表中都可以包含自己的属性表集合，用于描述某些场景的专有信息")])])])]),t._v(" "),_("blockquote",[_("p",[t._v("1，无符号数，以 u1、u2、u4、u8 分别代表 1 个字节、2 个字节、4 个字节、8 个字节的无符号数\n2，表，以“_info”结尾，由多个无符号数或其它表构成的复合数据类型")])]),t._v(" "),_("p",[t._v("源自："),_("a",{attrs:{href:"https://blog.csdn.net/a19881029/article/details/16117251",target:"_blank",rel:"noopener noreferrer"}},[t._v("JVM 笔记 5：Class 文件结构"),_("OutboundLink")],1)]),t._v(" "),_("h3",{attrs:{id:"_3、class-文件弊端"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3、class-文件弊端"}},[t._v("#")]),t._v(" 3、class 文件弊端：")]),t._v(" "),_("blockquote",[_("p",[t._v("由 class 文件结构（第 3 点）所导致")])]),t._v(" "),_("ul",[_("li",[t._v("内存占用大，不适合移动端")]),t._v(" "),_("li",[t._v("堆栈的加载模式，加载速度慢")]),t._v(" "),_("li",[t._v("文件 IO 操作多，类查找慢")])]),t._v(" "),_("p",[t._v("基于以上几个 class 文件的特点，又因为移动端运存较小（以当年的移动端手机为标准），class 并不适合直接在移动端设备上运行。")]),t._v(" "),_("h2",{attrs:{id:"二、dex-文件结构深入"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#二、dex-文件结构深入"}},[t._v("#")]),t._v(" 二、dex 文件结构深入")]),t._v(" "),_("h3",{attrs:{id:"_1、dex-文件结构"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_1、dex-文件结构"}},[t._v("#")]),t._v(" 1、dex 文件结构：")]),t._v(" "),_("ul",[_("li",[t._v("一种 8 位字节的二进制流文件")]),t._v(" "),_("li",[t._v("各个数据按顺序紧密的排列，无间隙")]),t._v(" "),_("li",[t._v("整个应用中所有 java 源文件都放在一个 dex 中")])]),t._v(" "),_("h3",{attrs:{id:"_2、dex-文件结构的详解"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2、dex-文件结构的详解"}},[t._v("#")]),t._v(" 2、dex 文件结构的详解：")]),t._v(" "),_("p",[t._v("dex 文件与 class 文件的结构有很大的不同，如下图所示：")]),t._v(" "),_("p",[_("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210105231908.png",alt:""}})]),t._v(" "),_("p",[t._v("对应的字段说明如下表所示：")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("数据名称")]),t._v(" "),_("th",[t._v("解释")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("header")]),t._v(" "),_("td",[t._v("dex 文件头部，记录整个 dex 文件的相关属性")])]),t._v(" "),_("tr",[_("td",[t._v("string_ids")]),t._v(" "),_("td",[t._v("字符串数据索引，记录了每个字符串在数据区的偏移量")])]),t._v(" "),_("tr",[_("td",[t._v("type_ids")]),t._v(" "),_("td",[t._v("类似数据索引，记录了每个类型的字符串索引")])]),t._v(" "),_("tr",[_("td",[t._v("proto_ids")]),t._v(" "),_("td",[t._v("原型数据索引，记录了方法声明的字符串，返回类型字符串，参数列表")])]),t._v(" "),_("tr",[_("td",[t._v("field_ids")]),t._v(" "),_("td",[t._v("字段数据索引，记录了所属类，类型以及方法名")])]),t._v(" "),_("tr",[_("td",[t._v("method_ids")]),t._v(" "),_("td",[t._v("类方法索引，记录方法所属类名，方法声明以及方法名等信息")])]),t._v(" "),_("tr",[_("td",[t._v("class_defs")]),t._v(" "),_("td",[t._v("类定义数据索引，记录指定类各类信息，包括接口，超类，类数据偏移量")])]),t._v(" "),_("tr",[_("td",[t._v("data")]),t._v(" "),_("td",[t._v("数据区，保存了各个类的真实数据")])]),t._v(" "),_("tr",[_("td",[t._v("link_data")]),t._v(" "),_("td",[t._v("连接数据区")])])])]),t._v(" "),_("h3",{attrs:{id:"_3、dex-头文件"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3、dex-头文件"}},[t._v("#")]),t._v(" 3、dex 头文件")]),t._v(" "),_("p",[t._v("下面是 dex 头文件中字段详解，与 class 文件的结构有部分相同的地方，但因为一个 dex 文件中包含 n 个 class 文件，在头文件中需要对所有 class 进行标记及记录相关信息，故会多出一些不同的字段。")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("字段名称")]),t._v(" "),_("th",[t._v("偏移值")]),t._v(" "),_("th",[t._v("长度")]),t._v(" "),_("th",[t._v("说明")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("magic")]),t._v(" "),_("td",[t._v("0x0")]),t._v(" "),_("td",[t._v("8")]),t._v(" "),_("td",[t._v('魔数字段，值为"dex\\n035\\0"')])]),t._v(" "),_("tr",[_("td",[t._v("checksum")]),t._v(" "),_("td",[t._v("0x8")]),t._v(" "),_("td",[t._v("4")]),t._v(" "),_("td",[t._v("校验码")])]),t._v(" "),_("tr",[_("td",[t._v("signature")]),t._v(" "),_("td",[t._v("0xc")]),t._v(" "),_("td",[t._v("20")]),t._v(" "),_("td",[t._v("sha-1 签名")])]),t._v(" "),_("tr",[_("td",[t._v("file_size")]),t._v(" "),_("td",[t._v("0x20")]),t._v(" "),_("td",[t._v("4")]),t._v(" "),_("td",[t._v("dex 文件总长度")])]),t._v(" "),_("tr",[_("td",[t._v("header_size")]),t._v(" "),_("td",[t._v("0x24")]),t._v(" "),_("td",[t._v("4")]),t._v(" "),_("td",[t._v("文件头长度，009 版本=0x5c,035 版本=0x70")])]),t._v(" "),_("tr",[_("td",[t._v("endian_tag")]),t._v(" "),_("td",[t._v("0x28")]),t._v(" "),_("td",[t._v("4")]),t._v(" "),_("td",[t._v("标示字节顺序的常量")])]),t._v(" "),_("tr",[_("td",[t._v("link_size")]),t._v(" "),_("td",[t._v("0x2c")]),t._v(" "),_("td",[t._v("4")]),t._v(" "),_("td",[t._v("链接段的大小，如果为 0 就是静态链接")])]),t._v(" "),_("tr",[_("td",[t._v("link_off")]),t._v(" "),_("td",[t._v("0x30")]),t._v(" "),_("td",[t._v("4")]),t._v(" "),_("td",[t._v("链接段的开始位置")])]),t._v(" "),_("tr",[_("td",[t._v("map_off")]),t._v(" "),_("td",[t._v("0x34")]),t._v(" "),_("td",[t._v("4")]),t._v(" "),_("td",[t._v("map 数据基址")])]),t._v(" "),_("tr",[_("td",[t._v("string_ids_size")]),t._v(" "),_("td",[t._v("0x38")]),t._v(" "),_("td",[t._v("4")]),t._v(" "),_("td",[t._v("字符串列表中字符串个数")])]),t._v(" "),_("tr",[_("td",[t._v("string_ids_off")]),t._v(" "),_("td",[t._v("0x3c")]),t._v(" "),_("td",[t._v("4")]),t._v(" "),_("td",[t._v("字符串列表基址")])]),t._v(" "),_("tr",[_("td",[t._v("type_ids_size")]),t._v(" "),_("td",[t._v("0x40")]),t._v(" "),_("td",[t._v("4")]),t._v(" "),_("td",[t._v("类列表里的类型个数")])]),t._v(" "),_("tr",[_("td",[t._v("type_ids_off")]),t._v(" "),_("td",[t._v("0x44")]),t._v(" "),_("td",[t._v("4")]),t._v(" "),_("td",[t._v("类列表基址")])]),t._v(" "),_("tr",[_("td",[t._v("proto_ids_size")]),t._v(" "),_("td",[t._v("0x48")]),t._v(" "),_("td",[t._v("4")]),t._v(" "),_("td",[t._v("原型列表里面的原型个数")])]),t._v(" "),_("tr",[_("td",[t._v("proto_ids_off")]),t._v(" "),_("td",[t._v("0x4c")]),t._v(" "),_("td",[t._v("4")]),t._v(" "),_("td",[t._v("原型列表基址")])]),t._v(" "),_("tr",[_("td",[t._v("field_ids_size")]),t._v(" "),_("td",[t._v("0x50")]),t._v(" "),_("td",[t._v("4")]),t._v(" "),_("td",[t._v("字段个数")])]),t._v(" "),_("tr",[_("td",[t._v("field_ids_off")]),t._v(" "),_("td",[t._v("0x54")]),t._v(" "),_("td",[t._v("4")]),t._v(" "),_("td",[t._v("字段列表基址")])]),t._v(" "),_("tr",[_("td",[t._v("method_ids_size")]),t._v(" "),_("td",[t._v("0x58")]),t._v(" "),_("td",[t._v("4")]),t._v(" "),_("td",[t._v("方法个数")])]),t._v(" "),_("tr",[_("td",[t._v("method_ids_off")]),t._v(" "),_("td",[t._v("0x5c")]),t._v(" "),_("td",[t._v("4")]),t._v(" "),_("td",[t._v("方法列表基址")])]),t._v(" "),_("tr",[_("td",[t._v("class_defs_size")]),t._v(" "),_("td",[t._v("0x60")]),t._v(" "),_("td",[t._v("4")]),t._v(" "),_("td",[t._v("类定义标中类的个数")])]),t._v(" "),_("tr",[_("td",[t._v("class_defs_off")]),t._v(" "),_("td",[t._v("0x64")]),t._v(" "),_("td",[t._v("4")]),t._v(" "),_("td",[t._v("类定义列表基址")])]),t._v(" "),_("tr",[_("td",[t._v("data_size")]),t._v(" "),_("td",[t._v("0x68")]),t._v(" "),_("td",[t._v("4")]),t._v(" "),_("td",[t._v("数据段的大小，必须 4k 对齐")])]),t._v(" "),_("tr",[_("td",[t._v("data_off")]),t._v(" "),_("td",[t._v("0x6c")]),t._v(" "),_("td",[t._v("4")]),t._v(" "),_("td",[t._v("数据段基址")])])])]),t._v(" "),_("p",[t._v("源自："),_("a",{attrs:{href:"https://www.jianshu.com/p/f7f0a712ddfe",target:"_blank",rel:"noopener noreferrer"}},[t._v("Dex 文件格式详解"),_("OutboundLink")],1)]),t._v(" "),_("p",[t._v("对于 class 文件及 dex 文件的结构 都可以使用 “010 editor” 这个神器进行查看验证，网上也有相关的文章说明，有兴趣的道友可自行百度 或 访问如下 2 篇文章进行查阅了解，这里便不再啰嗦：")]),t._v(" "),_("ul",[_("li",[_("a",{attrs:{href:"https://blog.csdn.net/a19881029/article/details/16117251",target:"_blank",rel:"noopener noreferrer"}},[t._v("JVM 笔记 5：Class 文件结构"),_("OutboundLink")],1)]),t._v(" "),_("li",[_("a",{attrs:{href:"https://www.jianshu.com/p/f7f0a712ddfe",target:"_blank",rel:"noopener noreferrer"}},[t._v("Dex 文件格式详解"),_("OutboundLink")],1)])]),t._v(" "),_("h3",{attrs:{id:"_4、dex-文件的优势"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_4、dex-文件的优势"}},[t._v("#")]),t._v(" 4、dex 文件的优势")]),t._v(" "),_("p",[t._v("dex 文件的头文件与索引区部分，保存了所有类及类中数据的索引，因此，dvm 可通过这两部分快速查找到对应类及数据，相对于直接运行 class 文件而言，效率上提升了不少。")]),t._v(" "),_("h2",{attrs:{id:"三、dex-与-class-两者的异同"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#三、dex-与-class-两者的异同"}},[t._v("#")]),t._v(" 三、dex 与 class 两者的异同")]),t._v(" "),_("p",[t._v("经过上面对 class 文件与 dex 文件的结构进行大概的了解之后，我们可以得出如下几个结论：")]),t._v(" "),_("ul",[_("li",[t._v("本质上都是一样的，dex 是从 class 文件演变而来的。")]),t._v(" "),_("li",[t._v("class 文件存在许多冗余信息，dex 文件会去除冗余，并整合。")])]),t._v(" "),_("p",[_("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/FullStackAction/PicBed@resource/image/20210105231928.png",alt:""}})]),t._v(" "),_("h2",{attrs:{id:"四、其他"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#四、其他"}},[t._v("#")]),t._v(" 四、其他")]),t._v(" "),_("h3",{attrs:{id:"_1、配置-android-及-dx-环境变量"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_1、配置-android-及-dx-环境变量"}},[t._v("#")]),t._v(" 1、配置 Android 及 dx 环境变量")]),t._v(" "),_("p",[t._v("以 mac 为例，windows 请百度。")]),t._v(" "),_("ol",[_("li",[t._v("到用户目录下：")])]),t._v(" "),_("div",{staticClass:"language-cmd extra-class"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[t._v("cd ~\n")])])]),_("ol",{attrs:{start:"2"}},[_("li",[t._v("打开.bash_profile 文件")])]),t._v(" "),_("div",{staticClass:"language-cmd extra-class"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[t._v("open -e .bash_profile\n")])])]),_("blockquote",[_("p",[t._v("如果当前用户目录下没有.bash_profile，可以使用 touch .bash_profile 自行创建")])]),t._v(" "),_("div",{staticClass:"language-cmd extra-class"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[t._v("export ANDROID_HOME=/Users/lqr/Library/Android/sdk\nexport PATH=${PATH}:${ANDROID_HOME}/tools\nexport PATH=${PATH}:${ANDROID_HOME}/platform-tools\nexport PATH=${PATH}:${ANDROID_HOME}/build-tools/27.0.3\n")])])]),_("blockquote",[_("p",[t._v("ANDROID_HOME 与 build-tools 的值需要根据电脑的情况修改。")])]),t._v(" "),_("ol",{attrs:{start:"3"}},[_("li",[t._v("配置生效")])]),t._v(" "),_("div",{staticClass:"language-cmd extra-class"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[t._v("source .bash_profile\n")])])]),_("ol",{attrs:{start:"4"}},[_("li",[t._v("测试")])]),t._v(" "),_("p",[t._v("在终端输入 adb 或 dx 命令看是否有命令反应即可。")])])}),[],!1,null,null,null);_.default=a.exports}}]);